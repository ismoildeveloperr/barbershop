!function(){"use strict";!function(e,t,s,i,n){class a{constructor(e,t={}){this.id=e,this.setupProperties(),this.setupValues(t)}setupProperties(){}setupValues(e){for(let t in e)this[t]=e[t]}getId(){return this.id}}class o extends a{setupProperties(){super.setupProperties(),this.name=""}}class r extends a{setupProperties(){super.setupProperties(),this.name=""}}function l(e){return e.filter(((e,t,s)=>s.indexOf(e)===t))}function p(e,t){return e.filter((e=>-1!=t.indexOf(e)))}function m(e,t){let s=Math.min(e.length,t.length),i={};for(let n=0;n<s;n++)i[e[n]]=t[n];return i}function c(e,t,s=1){let i=s||1,n=Math.abs(Math.floor((t-e)/i))+1;return[...Array(n).keys()].map((t=>t*s+e))}const h="undefined"!=typeof wp&&wp.i18n&&wp.i18n.__?wp.i18n.__:(e,t="")=>e,d="undefined"!=typeof wp&&wp.i18n&&wp.i18n._x?wp.i18n._x:(e,t,s="")=>e;"undefined"!=typeof wp&&wp.i18n&&wp.i18n.sprintf&&wp.i18n.sprintf;class u extends a{setupProperties(){super.setupProperties(),this.name="",this.price=0,this.depositType="disabled",this.depositAmount=0,this.duration=0,this.bufferTimeBefore=0,this.bufferTimeAfter=0,this.timeBeforeBooking="",this.maxAdvanceTimeBeforeReservation="",this.minCapacity=1,this.maxCapacity=1,this.multiplyPrice=!1,this.isGroupServiceEnabled=!1,this.customQuantityLabel="",this.variations={},this.image="",this.thumbnail=""}getName(){return this.name}getPrice(e=0,t=0){t||(t=this.minCapacity);let s=this.getVariation("price",e,this.price);return this.multiplyPrice&&(s*=t),s}getDuration(e=0){return this.getVariation("duration",e,this.duration)}getMinCapacity(e=0){return this.getVariation("min_capacity",e,this.minCapacity)}getMaxCapacity(e=0){return this.getVariation("max_capacity",e,this.maxCapacity)}getVariation(e,t,s){return t in this.variations?this.variations[t][e]:s}setName(e){this.name=e}isGroupService(){return this.isGroupServiceEnabled}getCustomQuantityLabel(){return this.customQuantityLabel}getQuantityLabel(){return""!==this.customQuantityLabel?this.getCustomQuantityLabel():h("Clients","motopress-appointment")}}class g{static loadInBackground(e,t,s=!1){return t.findById(e.id,s).then((t=>{if(null!==t)for(let s in t)e[s]=t[s];return t}))}}let y="/motopress/appointment/v1";function b(e,t={},s="GET"){return new Promise(((i,n)=>{wp.apiRequest({path:y+e,type:s,data:t}).done((e=>i(e))).fail(((e,t)=>{let s="parsererror";s=e.responseJSON&&e.responseJSON.message?e.responseJSON.message:`Status: ${t}`,"parsererror"==s&&(s="REST request failed. Maybe PHP error on the server side. Check PHP logs."),n(new Error(s))}))}))}function _(e,t={}){return b(e,t,"GET")}function f(e,t){return b(e,t,"POST")}class v{constructor(){this.settings=this.getDefaults(),this.loadingPromise=this.load()}getDefaults(){return{plugin_name:"Appointment Booking",today:"2030-01-01",business_name:"",default_time_step:30,default_booking_status:"confirmed",confirmation_mode:"auto",terms_page_id_for_acceptance:0,allow_multibooking:!1,allow_coupons:!1,allow_customer_account_creation:!1,country:"",currency:"EUR",currency_symbol:"&euro;",currency_position:"before",decimal_separator:".",thousand_separator:",",number_of_decimals:2,timezone:"UTC",date_format:"F j, Y",time_format:"H:i",week_starts_on:0,thumbnail_size:{width:150,height:150},flatpickr_locale:"en",enable_payments:!1,active_gateways:[],reservation_received_page_url:"",failed_transaction_page_url:"",default_payment_gateway:""}}load(){return new Promise(((e,t)=>{_("/settings").then((e=>this.settings=e),(e=>console.error("Unable to load public settings.",e))).finally((()=>e(this.settings)))}))}ready(){return this.loadingPromise}getPluginName(){return this.settings.plugin_name}getBusinessDate(){return this.settings.today}getBusinessName(){return this.settings.business_name}getTimeStep(){return this.settings.default_time_step}getDefaultBookingStatus(){return this.settings.default_booking_status}getConfirmationMode(){return this.settings.confirmation_mode}getTermsPageIdForAcceptance(){return this.settings.terms_page_id_for_acceptance}isMultibookingEnabled(){return this.settings.allow_multibooking}isCouponsEnabled(){return this.settings.allow_coupons}isAllowCustomerAccountCreation(){return this.settings.allow_customer_account_creation}getCountry(){return this.settings.country}getCurrency(){return this.settings.currency}getCurrencySymbol(){return this.settings.currency_symbol}getCurrencyPosition(){return this.settings.currency_position}getDecimalSeparator(){return this.settings.decimal_separator}getThousandSeparator(){return this.settings.thousand_separator}getDecimalsCount(){return this.settings.number_of_decimals}getTimezone(){return this.settings.timezone}getDateFormat(){return this.settings.date_format}getTimeFormat(){return this.settings.time_format}getFirstDayOfWeek(){return this.settings.week_starts_on}getThumbnailSize(){return this.settings.thumbnail_size}getFlatpickrLocale(){return this.settings.flatpickr_locale}isPaymentsEnabled(){return this.settings.enable_payments}getActiveGateways(){return this.settings.active_gateways}getReservationReceivedPageUrl(){return this.settings.reservation_received_page_url}getFailedTransactionPageUrl(){return this.settings.failed_transaction_page_url}getDefaultPaymentGateway(){return this.settings.default_payment_gateway}}class w{constructor(){this.settingsCtrl=new v,this.loadingPromise=this.load()}load(){return Promise.all([this.settingsCtrl.ready()]).then((()=>this))}ready(){return this.loadingPromise}settings(){return this.settingsCtrl}static getInstance(){return null==w.instance&&(w.instance=new w),w.instance}}function C(){return w.getInstance()}const S={weekdays:{shorthand:[h("Sun","motopress-appointment"),h("Mon","motopress-appointment"),h("Tue","motopress-appointment"),h("Wed","motopress-appointment"),h("Thu","motopress-appointment"),h("Fri","motopress-appointment"),h("Sat","motopress-appointment")],longhand:[h("Sunday","motopress-appointment"),h("Monday","motopress-appointment"),h("Tuesday","motopress-appointment"),h("Wednesday","motopress-appointment"),h("Thursday","motopress-appointment"),h("Friday","motopress-appointment"),h("Saturday","motopress-appointment")]},months:{shorthand:[h("Jan","motopress-appointment"),h("Feb","motopress-appointment"),h("Mar","motopress-appointment"),h("Apr","motopress-appointment"),d("May","Month (short)","motopress-appointment"),h("Jun","motopress-appointment"),h("Jul","motopress-appointment"),h("Aug","motopress-appointment"),h("Sep","motopress-appointment"),h("Oct","motopress-appointment"),h("Nov","motopress-appointment"),h("Dec","motopress-appointment")],longhand:[h("January","motopress-appointment"),h("February","motopress-appointment"),h("March","motopress-appointment"),h("April","motopress-appointment"),d("May","Month","motopress-appointment"),h("June","motopress-appointment"),h("July","motopress-appointment"),h("August","motopress-appointment"),h("September","motopress-appointment"),h("October","motopress-appointment"),h("November","motopress-appointment"),h("December","motopress-appointment")]},amPM:["AM","PM"],firstDayOfWeek:C().settings().getFirstDayOfWeek()};function E(e,s="public"){if("string"==typeof e)return e;if("internal"==s)return E(e,"Y-m-d");if("public"==s)return t.format(C().settings().getDateFormat(),e);let i=(e,t=2)=>("00"+e).slice(-t),n=!1;return s.split("").map((t=>{if(n)return n=!1,t;switch(t){case"\\":return n=!0,"";case"j":return e.getDate();case"d":return i(e.getDate());case"D":return S.weekdays.shorthand[e.getDay()];case"l":return S.weekdays.longhand[e.getDay()];case"N":return e.getDay()||7;case"w":return e.getDay();case"z":let s=new Date(e.getFullYear(),0,1),a=s.getTimezoneOffset()-e.getTimezoneOffset(),o=e-s+60*a*1e3,r=864e5;return Math.floor(o/r);case"W":let l=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),p=l.getUTCDay()||7;l.setUTCDate(l.getUTCDate()+4-p);let m=new Date(Date.UTC(l.getUTCFullYear(),0,1)),c=864e5;return Math.ceil(((l-m)/c+1)/7);case"F":return S.months.longhand[e.getMonth()];case"M":return S.months.shorthand[e.getMonth()];case"m":return i(e.getMonth()+1);case"n":return e.getMonth()+1;case"t":return new Date(e.getFullYear(),e.getMonth()+1,0).getDate();case"Y":return e.getFullYear();case"y":return String(e.getFullYear()).substring(2);case"L":return e.getFullYear()%4==0?1:0;case"A":return S.amPM[e.getHours()>11?1:0];case"a":return S.amPM[e.getHours()>11?1:0].toLowerCase();case"H":return i(e.getHours());case"h":return i(e.getHours()%12||12);case"G":return e.getHours();case"g":return e.getHours()%12||12;case"i":return i(e.getMinutes());case"s":return i(e.getSeconds());case"v":return i(e.getMilliseconds(),3);case"u":return i(e.getMilliseconds(),3)+"000";case"O":case"P":let h=-e.getTimezoneOffset(),d=h>=0?"+":"-",u=Math.floor(Math.abs(h)/60),g=Math.abs(h)%60,y="O"==t?"":":";return d+i(u)+y+i(g);case"Z":return 60*e.getTimezoneOffset();case"U":return Math.floor(e.getTime()/1e3);case"c":return E(e,"Y-m-d\\TH:i:sP");case"r":return E(e,"D, d M Y H:i:s O");case"S":case"o":case"B":case"e":case"T":case"I":return"";default:return t}})).join("")}function k(e){let t=e.match(/(\d{4})-(\d{2})-(\d{2})/);if(null!=t){let e=parseInt(t[1]),s=parseInt(t[2]),i=parseInt(t[3]);return new Date(e,s-1,i)}return null}function P(){let e=new Date;return e.setHours(0,0,0,0),e}class T extends a{setupProperties(){super.setupProperties(),this.status="new",this.code="",this.description="",this.type="fixed",this.amount=0,this.expirationDate=null,this.serviceIds=[],this.minDate=null,this.maxDate=null,this.usageLimit=0,this.usageCount=0}setupValues(e){for(let t of["expirationDate","minDate","maxDate"]){let s=e[t];null!=s&&""!==s&&(this[t]=k(s)),delete e[t]}super.setupValues(e)}getCode(){return this.code}isApplicableForCart(e){let t=!1;return e.items.forEach((e=>{if(this.isApplicableForCartItem(e))return t=!0,!1})),t}isApplicableForCartItem(e){return!!e.isSet()&&(!(this.serviceIds.length>0&&-1==this.serviceIds.indexOf(e.service.id))&&(!(null!=this.minDate&&e.date<this.minDate)&&!(null!=this.maxDate&&e.date>this.maxDate)))}calcDiscountAmount(e){let t=this.calcDiscountForCart(e);return Math.min(t,e.getSubtotalPrice())}calcDiscountForCart(e){let t=0;return e.items.forEach((e=>{t+=this.calcDiscountForCartItem(e)})),t}calcDiscountForCartItem(e){let t=0;if(this.isApplicableForCartItem(e)){let s=e.getPrice();switch(this.type){case"fixed":t=this.amount;break;case"percentage":t=s*this.amount/100}t=Math.min(t,s)}return t}}function I(e){return!!e}function $(e){let t=parseInt(e);return isNaN(t)?e<<0:t}class D{constructor(e){var t;this.postType=e,this.entityType=0===(t=e).indexOf("mpa_")?t.substring(4):0===t.indexOf("_mpa_")?t.substring(5):t,this.savedEntities={}}findById(e,t=!1){return e?!t&&this.haveEntity(e)&&null!=this.getEntity(e)?Promise.resolve(this.getEntity(e)):this.requestEntity(e).then((t=>{let s=this.mapRestDataToEntity(t);return this.saveEntity(e,s),s}),(t=>(this.saveEntity(e,null),null))):Promise.resolve(null)}findAll(e,t=!1){let s=[],i=[];for(let n of e)this.haveEntity(n)&&!t?i.push(this.getEntity(n)):s.push(n);return 0===s.length?Promise.resolve(i):this.requestEntities(s).then((e=>{for(let t of e){let e=this.mapRestDataToEntity(t);this.saveEntity(e.id,e),i.push(e)}return i}),(e=>[]))}requestEntity(e){return _(this.getRoute(),{id:e})}requestEntities(e){return _(this.getRoute(),{id:e})}haveEntity(e){return e in this.savedEntities}getEntity(e){return this.savedEntities[e]||null}saveEntity(e,t){this.savedEntities[e]=t}mapRestDataToEntity(e){return null}getRoute(){return`/${this.entityType}s`}}class x extends D{findByCode(e,t=!1){return _(this.getRoute(),{code:e}).then((e=>{let t=this.mapRestDataToEntity(e);return this.saveEntity(t.getId(),t),t}),(e=>{if(t)return null;throw e}))}mapRestDataToEntity(e){return new T(e.id,e)}}function M(e,t="public"){return E(e,"internal"==t?"H:i":"public"==t?C().settings().getTimeFormat():t)}function A(e){let t=e.split(":"),s=parseInt(t[0]),i=parseInt(t[1]),n=P();return n.setHours(s,i),n}class B{constructor(e,t=null){this.setupProperties(),null==t?this.parsePeriod(e):(this.setStartTime(e),this.setEndTime(t))}setupProperties(){this.startTime=null,this.endTime=null}parsePeriod(e){let t=e.split(" - ");this.setStartTime(t[0]),this.setEndTime(t[1])}setStartTime(e){this.startTime="string"==typeof e?A(e):new Date(e)}setEndTime(e){this.endTime="string"==typeof e?A(e):new Date(e),0===this.endTime.getHours()&&0===this.endTime.getMinutes()&&this.startTime.getFullYear()===this.endTime.getFullYear()&&this.startTime.getMonth()===this.endTime.getMonth()&&this.startTime.getDate()===this.endTime.getDate()&&this.endTime.setDate(this.endTime.getDate()+1)}setDate(e){this.startTime.setFullYear(e.getFullYear()),this.startTime.setMonth(e.getMonth(),e.getDate()),this.endTime.setFullYear(e.getFullYear()),this.endTime.setMonth(e.getMonth(),e.getDate()),0===this.endTime.getHours()&&0===this.endTime.getMinutes()&&this.startTime.getFullYear()===this.endTime.getFullYear()&&this.startTime.getMonth()===this.endTime.getMonth()&&this.startTime.getDate()===this.endTime.getDate()&&this.endTime.setDate(this.endTime.getDate()+1)}intersectsWith(e){return this.startTime<e.endTime&&this.endTime>e.startTime}isSubperiodOf(e){return this.startTime>=e.startTime&&this.endTime<=e.endTime}mergePeriod(e){this.startTime.setTime(Math.min(this.startTime.getTime(),e.startTime.getTime())),this.endTime.setTime(Math.max(this.endTime.getTime(),e.endTime.getTime()))}diffPeriod(e){this.startTime<e.startTime?this.endTime.setTime(Math.min(e.startTime.getTime(),this.endTime.getTime())):this.startTime.setTime(Math.max(e.endTime.getTime(),this.startTime.getTime()))}splitByPeriod(e){let t=[];return e.startTime.getTime()-this.startTime.getTime()>0&&t.push(new B(this.startTime,e.startTime)),this.endTime.getTime()-e.endTime.getTime()>0&&t.push(new B(e.endTime,this.endTime)),t}isEmpty(){return this.endTime.getTime()-this.startTime.getTime()<=0}toString(e="public",t=" - "){"internal"==e&&(t=" - ");let s="short"==e?"public":e,i=M(this.startTime,s),n=M(this.endTime,s);return"internal"!==e&&0===this.startTime.getHours()&&0===this.startTime.getMinutes()&&i===n?h("All day","motopress-appointment"):"short"==e&&i==n?i:i+t+n}}class L extends a{setupProperties(){super.setupProperties(),this.serviceId=0,this.date=null,this.serviceTime=null,this.bufferTime=null}setupValues(e){for(let t in e)"date"==t?this.setDate(e[t]):"serviceTime"==t?this.setServiceTime(e[t]):"bufferTime"==t?this.setBufferTime(e[t]):this[t]=e[t]}setDate(e){this.date="string"==typeof e?k(e):e,null!=this.serviceTime&&this.serviceTime.setDate(this.date),null!=this.bufferTime&&this.bufferTime.setDate(this.date)}setServiceTime(e){this.serviceTime="string"==typeof e?new B(e):e,null!=this.date&&this.serviceTime.setDate(this.date)}setBufferTime(e){this.bufferTime="string"==typeof e?new B(e):e,null!=this.date&&this.bufferTime.setDate(this.date)}}class F extends D{findAllByService(e,t={}){let s={service_id:e};return null!=t.from_date&&(s.from_date=E(t.from_date,"internal")),null!=t.to_date&&(s.to_date=E(t.to_date,"internal")),_("/bookings/reservations",s).then((e=>{let t=[];for(let s of e){let e=this.mapRestDataToEntity(s);this.saveEntity(e.id,e),t.push(e)}return t})).catch((e=>(console.error("No reservations found.",e.message),[])))}mapRestDataToEntity(e){return new L(e.id,e)}}class R{constructor(e,t=null){this.setupProperties(),null==t?this.parsePeriod(e):(this.setStartDate(e),this.setEndDate(t))}setupProperties(){this.startDate=null,this.endDate=null}parsePeriod(e){let t=e.split(" - ");this.setStartDate(t[0]),this.setEndDate(t[1])}setStartDate(e){this.startDate=this.convertToDate(e)}setEndDate(e){this.endDate=this.convertToDate(e)}convertToDate(e){return"string"==typeof e?k(e)||P():new Date(e)}calcDays(){let e=this.endDate.getTime()-this.startDate.getTime();return Math.round(e/1e3/3600/24)}inPeriod(e){return"string"==typeof e&&(e=k(e)),null!=e&&e>=this.startDate&&e<=this.endDate}splitToDates(){let e={};for(let t=new Date(this.startDate);t<=this.endDate;t.setDate(t.getDate()+1)){let s=E(t,"internal"),i=new Date(t);e[s]=i}return e}toString(){return E(this.startDate,"internal")+" - "+E(this.endDate,"internal")}}class O extends a{setupProperties(){super.setupProperties(),this.timetable=[],this.workTimetable=[],this.customWorkdays=[],this.daysOff={}}setupValues(e){for(let t in e)"timetable"==t?this.setTimetable(e[t]):"customWorkdays"==t?this.setCustomWorkdays(e[t]):"daysOff"==t?this.setDaysOff(e[t]):this[t]=e[t]}setTimetable(e){this.timetable=[],this.workTimetable=[],e.forEach((e=>{let t=[],s=[];e.forEach((e=>{let i=new B(e.time_period);t.push({time_period:i,location:e.location,activity:e.activity}),"work"==e.activity&&s.push({time_period:i,location:e.location})})),this.timetable.push(t),this.workTimetable.push(s)}))}setCustomWorkdays(e){this.customWorkdays=[];for(let t of e)this.customWorkdays.push({date_period:new R(t.date_period),time_period:new B(t.time_period)})}setDaysOff(e){this.daysOff={};for(let t of e){let e=new R(t).splitToDates();jQuery.extend(this.daysOff,e)}}isDayOff(e){return"string"!=typeof e&&(e=E(e,"internal")),e in this.daysOff}getWorkingHours(e,t=0){if(this.isDayOff(e))return[];if("string"==typeof e&&(e=k(e)),null==e)return[];let s=[],i=e.getDay();for(let e of this.workTimetable[i])0!=t&&e.location!=t||s.push(e.time_period);for(let t of this.customWorkdays)t.date_period.inPeriod(e)&&s.push(t.time_period);return s}}class N extends D{mapRestDataToEntity(e){return new O(e.id,e)}}class H extends D{mapRestDataToEntity(e){return new u(e.id,e)}}class V{constructor(){this.repositories={}}schedule(){return null==this.repositories.schedule&&(this.repositories.schedule=new N("mpa_schedule")),this.repositories.schedule}service(){return null==this.repositories.service&&(this.repositories.service=new H("mpa_service")),this.repositories.service}reservation(){return null==this.repositories.reservation&&(this.repositories.reservation=new F("mpa_reservation")),this.repositories.reservation}coupon(){return null==this.repositories.coupon&&(this.repositories.coupon=new x("mpa_coupon")),this.repositories.coupon}customer(){return void 0===this.repositories.customer&&(this.repositories.customer=new CustomerRepository),this.repositories.customer}static getInstance(){return null==V.instance&&(V.instance=new V),V.instance}}function z(){return V.getInstance()}let q=null;function U(e){return I(e)}let j={};function W(e,t=!1){return"object"==typeof e?0==function(e,t=!1){return"object"==typeof e?Array.isArray(e)?e.length:Object.keys(e).length:t?0:1}(e):!!t||!e}function G(e="",t=!1){let s=function(e,t){return t<(e=parseInt(e,10).toString(16)).length?e.slice(e.length-t):t>e.length?Array(t-e.length+1).join("0")+e:e};j.uniqid_seed||(j.uniqid_seed=Math.floor(123456789*Math.random())),j.uniqid_seed++;let i=e;return i+=s(parseInt((new Date).getTime()/1e3,10),8),i+=s(j.uniqid_seed,5),t&&(i+=(10*Math.random()).toFixed(8).toString()),i}class Y{setupProperties(){this.availability={},this.services={},this.serviceCategories={},this.employees={},this.locations={},this.servicePromise=null,this.readyPromise=null}constructor(){this.setupProperties()}load(e=!1){return this.readyPromise=function(e=!1){return(e||null==q)&&(q=_("/services/available").catch((e=>(console.error("Unable to extract available services."),{})))),q}(e).then((e=>(this.setAvailability(e),this))),this.readyPromise}setAvailability(e){this.availability=e;for(let t in e){let s=e[t];this.services[t]=s.name;for(let e in s.categories){let t=s.categories[e];this.serviceCategories[e]=t}for(let e in s.employees){let t=s.employees[e];this.employees[e]=t.name;for(let e in t.locations){let s=t.locations[e];this.locations[e]=s}}}}isEmpty(){return W(this.availability)}ready(){return null===this.readyPromise&&this.load(),this.readyPromise}getServicePromise(){return this.servicePromise}getService(e,t=!0,s=null){let i=new u(e);return this.services.hasOwnProperty(e)&&i.setName(this.services[e]),!0===t?(this.servicePromise=g.loadInBackground(i,z().service()),null!==s&&this.servicePromise.then(s),this.servicePromise.then((()=>i))):this.servicePromise=null,i}getServiceCategories(e){return this.availability[e].categories}getEmployee(e){let t=new o(e);return this.employees.hasOwnProperty(e)&&(t.name=this.employees[e]),t}getLocation(e){let t=new r(e);return this.locations.hasOwnProperty(e)&&(t.name=this.locations[e]),t}getAvailableServices(e="",t=0,s=0){let i={};for(let n in this.availability){let a=this.availability[n];if(""===e||e in a.categories){if(0!==t){let e=!1;if(Object.keys(a.employees).forEach((s=>{a.employees[s].locations.hasOwnProperty(t)&&(e=!0)})),!e)continue}(0===s||s in a.employees)&&(i[n]=a.name)}}return i}getAvailableServiceCategories(){let e={};for(let t in this.availability){let s=this.availability[t];jQuery.extend(e,s.categories)}return e}getAvailableEmployees(e=0,t=0){let s={};for(let i in this.availability){if(0!=e&&i!=e)continue;let n=this.availability[i];for(let e in n.employees){let i=n.employees[e];(0===t||t in i.locations)&&(s[e]=i.name)}}return s}getAvailableLocations(e=0,t=0){let s={};for(let i in this.availability){if(0!=e&&i!=e)continue;let n=this.availability[i];for(let e in n.employees){if(0!=t&&e!=t)continue;let i=n.employees[e];jQuery.extend(s,i.locations)}}return s}isAvailableServiceCategory(e){return this.getAvailableServiceCategories().hasOwnProperty(e)}isAvailableService(e){return this.getAvailableServices().hasOwnProperty(e)}isAvailableLocation(e){return this.getAvailableLocations().hasOwnProperty(e)}isAvailableEmployee(e){return this.getAvailableEmployees().hasOwnProperty(e)}filterAvailableEmployees(e,t=0,s="ids"){if(!(e in this.availability))return[];let i=[];Array.isArray(t)?i=t.filter(U):0!==t&&i.push(t);let n=[];for(let t in this.availability[e].employees){t=$(t);let s=this.availability[e].employees[t];if(0===i.length)n.push(t);else{p(i,Object.keys(s.locations).map($)).length>0&&n.push(t)}}return 0===n.length?[]:"entities"===s?n.map((e=>this.getEmployee(e))):n}filterAvailableLocations(e,t=0,s="ids"){if(!(e in this.availability))return[];let i=[];Array.isArray(t)?i=t.filter(U):0!==t&&i.push(t);let n=[];for(t in this.availability[e].employees){if(t=$(t),i.length>0&&-1===i.indexOf(t))continue;let s=this.availability[e].employees[t];for(let e in s.locations)n.push($(e))}return n=l(n),0===n.length?[]:"entities"===s?n.map((e=>this.getLocation(e))):n}}const{Component:Q,Fragment:K}=wp.element,{SelectControl:Z,PanelBody:J,TextControl:X,Tooltip:ee,ToggleControl:te,RangeControl:se}=wp.components,{InspectorControls:ie,PanelColorSettings:ne}=wp.blockEditor||wp.editor;let ae=class extends Q{constructor(){super(),this.availability=new Y,this.availability.ready().finally((()=>{this.availability.getAvailableServiceCategories(),this.availability.getAvailableServices(),this.availability.getAvailableEmployees(),this.availability.getAvailableLocations()}))}getSelectOptions(e,t,s){let i=[{value:t,label:s}];for(const t in e){let s={};s.value=t,s.label=e[t],i.push(s)}return i}render(){const{form_title:e,show_category:t,show_service:i,show_location:n,show_employee:a,label_category:o,label_service:r,label_location:l,label_employee:p,label_unselected:m,label_option:c,default_category:h,default_service:d,default_location:u,default_employee:g,timepicker_columns:y,show_timepicker_end_time:b,show_add_to_calendar:_,primary_color:f,primary_bg_color:v,secondary_color:w,secondary_bg_color:C,buttons_padding:S,form_width:E}=this.props.attributes,{setAttributes:k}=this.props,P=$(d),T=$(g),I=$(u),D=this.availability.isAvailableServiceCategory(h)?h:"",x=this.availability.isAvailableService(P)?P:0,M=this.availability.isAvailableLocation(I)?I:0,A=this.availability.isAvailableEmployee(T)?T:0,B=this.availability.getAvailableServiceCategories(),L=this.availability.getAvailableServices(D,M,A),F=this.availability.getAvailableLocations(x,A),R=this.availability.getAvailableEmployees(x,M),O=this.getSelectOptions(B,"",s.__("— Any —","motopress-appointment")),N=this.getSelectOptions(L,0,s.__("— Unselected —","motopress-appointment")),H=this.getSelectOptions(F,0,s.__("— Any —","motopress-appointment")),V=this.getSelectOptions(R,0,s.__("— Any —","motopress-appointment")),z=wp.element.createElement(te,{label:s.__("Show Category?","motopress-appointment"),help:s.__("Show the service category field in the form.","motopress-appointment"),checked:!1!==i&&t,disabled:!1===i,onChange:e=>{k({show_category:e})}}),q=!1===i?wp.element.createElement(ee,{text:s.sprintf(s.__("To enable this option, you need to check the '%s' box.","motopress-appointment"),s.__("Show Service?","motopress-appointment"))},wp.element.createElement("div",{style:{display:"inline-block"}},z)):z,U=wp.element.createElement(te,{label:s.__("Show Service?","motopress-appointment"),help:s.__("Show the service field in the form.","motopress-appointment"),checked:0===x||i,disabled:0===x,onChange:e=>{k({show_service:e})}}),j=0===x?wp.element.createElement(ee,{text:s.__("To enable booking for the specific service only, select the service below first, then uncheck the 'Service' box here.","motopress-appointment")},wp.element.createElement("div",{style:{display:"inline-block"}},U)):U;return wp.element.createElement(React.Fragment,null,wp.element.createElement(ie,null,wp.element.createElement(J,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(X,{label:s.__("Form Title","motopress-appointment"),value:e,onChange:e=>{k({form_title:e})}}),wp.element.createElement(Z,{label:s.__("Service","motopress-appointment"),help:s.__("ID of the selected service.","motopress-appointment"),value:x,onChange:e=>k({default_service:e}),options:N}),q,j,wp.element.createElement(te,{label:s.__("Show Location?","motopress-appointment"),help:s.__("Show the location field in the form.","motopress-appointment"),checked:n,onChange:e=>{k({show_location:e})}}),wp.element.createElement(te,{label:s.__("Show Employee?","motopress-appointment"),help:s.__("Show the employee field in the form.","motopress-appointment"),checked:a,onChange:e=>{k({show_employee:e})}}),wp.element.createElement(te,{label:s.__("Show 'Add to Your Calendar?' section.","motopress-appointment"),help:s.__("Allow customers to add an appointment to their own Google, Apple, Outlook, or Yahoo calendar.","motopress-appointment"),checked:_,onChange:e=>{k({show_add_to_calendar:e})}}),wp.element.createElement(X,{label:s.__("Category Field Label","motopress-appointment"),help:s.__("Custom label for the service category field.","motopress-appointment"),placeholder:s.__("Service Category","motopress-appointment"),value:o,onChange:e=>{k({label_category:e})}}),wp.element.createElement(X,{label:s.__("Service Field Label","motopress-appointment"),help:s.__("Custom label for the service field.","motopress-appointment"),placeholder:s.__("Service","motopress-appointment"),value:r,onChange:e=>{k({label_service:e})}}),wp.element.createElement(X,{label:s.__("Location Field Label","motopress-appointment"),help:s.__("Custom label for the location field.","motopress-appointment"),placeholder:s.__("Location","motopress-appointment"),value:l,onChange:e=>{k({label_location:e})}}),wp.element.createElement(X,{label:s.__("Employee Field Label","motopress-appointment"),help:s.__("Custom label for the employee field.","motopress-appointment"),placeholder:s.__("Employee","motopress-appointment"),value:p,onChange:e=>{k({label_employee:e})}}),wp.element.createElement(X,{label:s.__("Unselected Service","motopress-appointment"),help:s.__("Custom label for the unselected service field.","motopress-appointment"),placeholder:s.__("— Select —","motopress-appointment"),value:m,onChange:e=>{k({label_unselected:e})}}),wp.element.createElement(X,{label:s.__("Unselected Option","motopress-appointment"),help:s.__("Custom label for the unselected service category, location and employee fields.","motopress-appointment"),placeholder:s.__("— Any —","motopress-appointment"),value:c,onChange:e=>{k({label_option:e})}}),wp.element.createElement(Z,{label:s.__("Service Category","motopress-appointment"),help:s.__("Slug of the selected service category.","motopress-appointment"),value:D,onChange:e=>k({default_category:e}),options:O}),wp.element.createElement(Z,{label:s.__("Location","motopress-appointment"),help:s.__("ID of the selected location.","motopress-appointment"),value:M,onChange:e=>k({default_location:e}),options:H}),wp.element.createElement(Z,{label:s.__("Employee","motopress-appointment"),help:s.__("ID of the selected employee.","motopress-appointment"),value:A,onChange:e=>k({default_employee:e}),options:V}),wp.element.createElement(se,{label:s.__("Timepicker Columns Count","motopress-appointment"),help:s.__("The number of columns in the timepicker.","motopress-appointment"),value:y,onChange:e=>k({timepicker_columns:e}),min:1,max:5}),wp.element.createElement(te,{label:s.__("Show End Time?","motopress-appointment"),help:s.__("Show the time when the appointment ends.","motopress-appointment"),checked:b,onChange:e=>{k({show_timepicker_end_time:e})}}))),wp.element.createElement(ie,{group:"styles"},wp.element.createElement(J,null,wp.element.createElement("span",null,s.__("These options only affect what you see on the front end.","motopress-appointment"))),wp.element.createElement(ne,{__experimentalIsRenderedInSidebar:!0,title:s.__("Colors","motopress-appointment"),colorSettings:[{value:f,onChange:e=>{k({primary_color:e})},label:s.__("Primary Text Color","motopress-appointment")},{value:v,onChange:e=>{k({primary_bg_color:e})},label:s.__("Primary Background Color","motopress-appointment")},{value:w,onChange:e=>{k({secondary_color:e})},label:s.__("Secondary Text Color","motopress-appointment")},{value:C,onChange:e=>{k({secondary_bg_color:e})},label:s.__("Secondary Background Color","motopress-appointment")}]}),wp.element.createElement(J,null,wp.element.createElement(X,{label:s.__("Form Width","motopress-appointment"),help:s.__("Example: 100%","motopress-appointment"),value:E,onChange:e=>{k({form_width:e})}}),wp.element.createElement(X,{label:s.__("Buttons Padding","motopress-appointment"),help:s.__("Example: 5px 10px","motopress-appointment"),value:S,onChange:e=>{k({buttons_padding:e})}}))))}};function oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var re,le,pe={exports:{}},me={exports:{}};re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",le={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&le.rotl(e,8)|4278255360&le.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=le.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],s=0,i=0;s<e.length;s++,i+=8)t[i>>>5]|=e[s]<<24-i%32;return t},wordsToBytes:function(e){for(var t=[],s=0;s<32*e.length;s+=8)t.push(e[s>>>5]>>>24-s%32&255);return t},bytesToHex:function(e){for(var t=[],s=0;s<e.length;s++)t.push((e[s]>>>4).toString(16)),t.push((15&e[s]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],s=0;s<e.length;s+=2)t.push(parseInt(e.substr(s,2),16));return t},bytesToBase64:function(e){for(var t=[],s=0;s<e.length;s+=3)for(var i=e[s]<<16|e[s+1]<<8|e[s+2],n=0;n<4;n++)8*s+6*n<=8*e.length?t.push(re.charAt(i>>>6*(3-n)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],s=0,i=0;s<e.length;i=++s%4)0!=i&&t.push((re.indexOf(e.charAt(s-1))&Math.pow(2,-2*i+8)-1)<<2*i|re.indexOf(e.charAt(s))>>>6-2*i);return t}},me.exports=le;var ce=me.exports,he={utf8:{stringToBytes:function(e){return he.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(he.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],s=0;s<e.length;s++)t.push(255&e.charCodeAt(s));return t},bytesToString:function(e){for(var t=[],s=0;s<e.length;s++)t.push(String.fromCharCode(e[s]));return t.join("")}}},de=he,ue=function(e){return null!=e&&(ge(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&ge(e.slice(0,0))}(e)||!!e._isBuffer)};function ge(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}!function(){var e=ce,t=de.utf8,s=ue,i=de.bin,n=function(a,o){a.constructor==String?a=o&&"binary"===o.encoding?i.stringToBytes(a):t.stringToBytes(a):s(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||a.constructor===Uint8Array||(a=a.toString());for(var r=e.bytesToWords(a),l=8*a.length,p=1732584193,m=-271733879,c=-1732584194,h=271733878,d=0;d<r.length;d++)r[d]=16711935&(r[d]<<8|r[d]>>>24)|4278255360&(r[d]<<24|r[d]>>>8);r[l>>>5]|=128<<l%32,r[14+(l+64>>>9<<4)]=l;var u=n._ff,g=n._gg,y=n._hh,b=n._ii;for(d=0;d<r.length;d+=16){var _=p,f=m,v=c,w=h;p=u(p,m,c,h,r[d+0],7,-680876936),h=u(h,p,m,c,r[d+1],12,-389564586),c=u(c,h,p,m,r[d+2],17,606105819),m=u(m,c,h,p,r[d+3],22,-1044525330),p=u(p,m,c,h,r[d+4],7,-176418897),h=u(h,p,m,c,r[d+5],12,1200080426),c=u(c,h,p,m,r[d+6],17,-1473231341),m=u(m,c,h,p,r[d+7],22,-45705983),p=u(p,m,c,h,r[d+8],7,1770035416),h=u(h,p,m,c,r[d+9],12,-1958414417),c=u(c,h,p,m,r[d+10],17,-42063),m=u(m,c,h,p,r[d+11],22,-1990404162),p=u(p,m,c,h,r[d+12],7,1804603682),h=u(h,p,m,c,r[d+13],12,-40341101),c=u(c,h,p,m,r[d+14],17,-1502002290),p=g(p,m=u(m,c,h,p,r[d+15],22,1236535329),c,h,r[d+1],5,-165796510),h=g(h,p,m,c,r[d+6],9,-1069501632),c=g(c,h,p,m,r[d+11],14,643717713),m=g(m,c,h,p,r[d+0],20,-373897302),p=g(p,m,c,h,r[d+5],5,-701558691),h=g(h,p,m,c,r[d+10],9,38016083),c=g(c,h,p,m,r[d+15],14,-660478335),m=g(m,c,h,p,r[d+4],20,-405537848),p=g(p,m,c,h,r[d+9],5,568446438),h=g(h,p,m,c,r[d+14],9,-1019803690),c=g(c,h,p,m,r[d+3],14,-187363961),m=g(m,c,h,p,r[d+8],20,1163531501),p=g(p,m,c,h,r[d+13],5,-1444681467),h=g(h,p,m,c,r[d+2],9,-51403784),c=g(c,h,p,m,r[d+7],14,1735328473),p=y(p,m=g(m,c,h,p,r[d+12],20,-1926607734),c,h,r[d+5],4,-378558),h=y(h,p,m,c,r[d+8],11,-2022574463),c=y(c,h,p,m,r[d+11],16,1839030562),m=y(m,c,h,p,r[d+14],23,-35309556),p=y(p,m,c,h,r[d+1],4,-1530992060),h=y(h,p,m,c,r[d+4],11,1272893353),c=y(c,h,p,m,r[d+7],16,-155497632),m=y(m,c,h,p,r[d+10],23,-1094730640),p=y(p,m,c,h,r[d+13],4,681279174),h=y(h,p,m,c,r[d+0],11,-358537222),c=y(c,h,p,m,r[d+3],16,-722521979),m=y(m,c,h,p,r[d+6],23,76029189),p=y(p,m,c,h,r[d+9],4,-640364487),h=y(h,p,m,c,r[d+12],11,-421815835),c=y(c,h,p,m,r[d+15],16,530742520),p=b(p,m=y(m,c,h,p,r[d+2],23,-995338651),c,h,r[d+0],6,-198630844),h=b(h,p,m,c,r[d+7],10,1126891415),c=b(c,h,p,m,r[d+14],15,-1416354905),m=b(m,c,h,p,r[d+5],21,-57434055),p=b(p,m,c,h,r[d+12],6,1700485571),h=b(h,p,m,c,r[d+3],10,-1894986606),c=b(c,h,p,m,r[d+10],15,-1051523),m=b(m,c,h,p,r[d+1],21,-2054922799),p=b(p,m,c,h,r[d+8],6,1873313359),h=b(h,p,m,c,r[d+15],10,-30611744),c=b(c,h,p,m,r[d+6],15,-1560198380),m=b(m,c,h,p,r[d+13],21,1309151649),p=b(p,m,c,h,r[d+4],6,-145523070),h=b(h,p,m,c,r[d+11],10,-1120210379),c=b(c,h,p,m,r[d+2],15,718787259),m=b(m,c,h,p,r[d+9],21,-343485551),p=p+_>>>0,m=m+f>>>0,c=c+v>>>0,h=h+w>>>0}return e.endian([p,m,c,h])};n._ff=function(e,t,s,i,n,a,o){var r=e+(t&s|~t&i)+(n>>>0)+o;return(r<<a|r>>>32-a)+t},n._gg=function(e,t,s,i,n,a,o){var r=e+(t&i|s&~i)+(n>>>0)+o;return(r<<a|r>>>32-a)+t},n._hh=function(e,t,s,i,n,a,o){var r=e+(t^s^i)+(n>>>0)+o;return(r<<a|r>>>32-a)+t},n._ii=function(e,t,s,i,n,a,o){var r=e+(s^(t|~i))+(n>>>0)+o;return(r<<a|r>>>32-a)+t},n._blocksize=16,n._digestsize=16,pe.exports=function(t,s){if(null==t)throw new Error("Illegal argument "+t);var a=e.wordsToBytes(n(t,s));return s&&s.asBytes?a:s&&s.asString?i.bytesToString(a):e.bytesToHex(a)}}();var ye=oe(pe.exports);class be{setupProperties(){this.itemId="",this.service=null,this.serviceCategories={},this.employee=null,this.location=null,this.date=null,this.time=null,this.capacity=1,this.availableEmployees=[],this.availableLocations=[],this.bookingVariants=[]}constructor(e){this.setupProperties(),this.itemId=e}getDate(){return this.date}getTime(){return this.time}getItemId(){return this.itemId}getAvailableEmployeeIds(){return this.availableEmployees.map((e=>e.id))}getAvailableLocationIds(){return this.availableLocations.map((e=>e.id))}getAvailableIds(){return{service_id:null!==this.service?this.service.id:0,employee_id:null!==this.employee?this.employee.id:0,employee_ids:this.getAvailableEmployeeIds(),location_ids:this.getAvailableLocationIds()}}getIds(){return{service_id:null!==this.service?this.service.id:0,employee_id:null!==this.employee?this.employee.id:0,location_id:null!==this.location?this.location.id:0}}toArray(e="all"){return"ids"===e?this.getIds():"availability"===e?this.getAvailableIds():"period"===e?{date:null!==this.date?E(this.date,"internal"):"",time:null!==this.time?this.time.toString("internal"):""}:jQuery.extend(this.getIds(),{date:null!==this.date?E(this.date,"internal"):"",time:null!==this.time?this.time.toString("internal"):"",capacity:this.capacity})}isSet(e="all"){let t=!0;return"all"!==e&&"ids"!==e||(t=t&&null!==this.service&&null!==this.employee&&null!==this.location),"all"!==e&&"period"!==e||(t=t&&null!==this.date&&null!==this.time),t}isAtTime(e,t){return null!==this.date&&null!==this.time&&E(this.date,"internal")==E(e,"internal")&&this.time.toString("internal")==t.toString("internal")}getCapacity(){return this.capacity}getMinCapacity(){return null!==this.service?this.service.getMinCapacity(this.getEmployeeId()):1}getMaxCapacity(){return null!==this.service?this.service.getMaxCapacity(this.getEmployeeId()):1}getMinPossibleCapacity(){if(null===this.service)return 1;{let e=this.getMaxCapacity();for(let t of this.bookingVariants)e=Math.min(e,t.minCapacity);return e}}getMaxPossibleCapacity(){if(null===this.service)return 1;{let e=this.getMinCapacity();for(let t of this.bookingVariants)e=Math.max(e,t.maxCapacity);return e}}getCapacityOptions(){if(null===this.service)return[1];{let e=[];for(let t of this.bookingVariants)e=e.concat(c(t.minCapacity,t.maxCapacity));return l(e)}}getPrice(){if(!this.service)return 0;let e=this.employee?this.employee.id:0;return this.service.getPrice(e,this.capacity)}getDeposit(e){let t=0;switch(this.service.depositType){case"disabled":default:t=e;break;case"fixed":t=this.service.depositAmount;break;case"percentage":t=e*this.service.depositAmount/100}return t>e?e:t}getHash(e="all"){return ye(JSON.stringify(this.toArray(e)))}didChange(e,t="all"){return e!==this.getHash(t)}getEmployeeId(){return this.employee?this.employee.getId():0}getEmployee(e){if(null!==this.employee&&this.employee.getId()==e)return this.employee;for(let t of this.availableEmployees)if(t.id==e)return t;return null}getLocationId(){return this.location?this.location.getId():0}getLocation(e){if(null!==this.location&&this.location.id==e)return this.location;for(let t of this.availableLocations)if(t.id==e)return t;return null}getService(){return this.service}hasMultipleAvailableEmployees(){return this.availableEmployees.length>1}hasMultipleAvailableLocations(){return this.availableLocations.length>1}hasMultipleAvailableVariants(){return this.hasMultipleAvailableEmployees()||this.hasMultipleAvailableLocations()}setService(e){this.service=e}setServiceCategories(e){this.serviceCategories=e}setEmployee(e,t=!0){"number"==typeof e&&(e=this.getEmployee(e)),this.employee=e,!0===t&&(this.availableEmployees=[e])}setAvailableEmployees(e,t=!0){this.availableEmployees=e,!0===t&&(this.employee=null)}setLocation(e,t=!0){"number"==typeof e&&(e=this.getLocation(e)),this.location=e,!0===t&&(this.availableLocations=[e])}setAvailableLocations(e,t=!0){this.availableLocations=e,!0===t&&(this.location=null)}setCapacity(e){this.capacity=e}setBookingVariants(e){this.bookingVariants=[];for(let t of e)this.bookingVariants.push({employeeId:t[0],locationId:t[1],minCapacity:t[2],maxCapacity:t[3]})}getBookingVariantForCapacity(e){for(let t of this.bookingVariants)if(e>=t.minCapacity&&e<=t.maxCapacity)return t;return{employeeId:this.getEmployeeId(),locationId:this.getLocationId(),minCapacity:this.getMinCapacity(),maxCapacity:this.getMaxCapacity()}}removeBookingVariatForEmployee(e){for(let t in this.bookingVariants){this.bookingVariants[t].employeeId==e&&this.bookingVariants.splice(t,1)}}}class _e{constructor(e=null){this.setupProperties(),null!=e&&this.merge(e)}setupProperties(){this.keys=[],this.values={},this.length=0}merge(e){for(let t in e)this.push(t,e[t])}push(e,t){let s=!this.includesKey(e);return this.values[e]=t,s&&(this.keys.push(e),this.length++),s}find(e,t=null){return this.includesKey(e)?this.values[e]:t}findNext(e,t=null){let s=this.findNextKey(e);return""!==s?this.values[s]:t}findNextKey(e){let t=this.keys.indexOf(e);if(-1===t)return"";let s=t+1;return s<this.length?this.keys[s]:this.keys[t]}findPrevious(e,t=null){let s=this.findPreviousKey(e);return""!==s?this.values[s]:t}findPreviousKey(e){let t=this.keys.indexOf(e);if(-1===t)return"";let s=t-1;return s>=0?this.keys[s]:this.keys[t]}update(e,t){return this.push(e,t)}remove(e){if(!this.includesKey(e))return null;let t=this.values[e];delete this.values[e];let s=this.keys.indexOf(e);return this.keys.splice(s,1),this.length--,t}empty(){return this.keys=[],this.values={},this.length=0,this}isEmpty(){return 0==this.length}includesKey(e){return e in this.values}firstKey(){return this.keys.length>0?this.keys[0]:null}firstValue(){let e=this.firstKey();return null!==e?this.values[e]:null}lastValue(){let e=this.lastKey();return null!=e?this.values[e]:null}lastKey(){return this.isEmpty()?null:this.keys[this.length-1]}cloneKeys(){return[...this.keys]}getColumn(e){let t=[];for(let s of this.keys){let i=this.values[s][e];null!=i&&(Array.isArray(i)?t=t.concat(i):t.push(i))}return l(t)}forEach(e){let t=0;for(let s of this.keys){let i=e(this.values[s],t,s,this);if(t++,!1===i)break}}map(e){let t=[],s=0;for(let i of this.keys)t.push(e(this.values[i],s,i,this)),s++;return t}toArray(){let e=[];for(let t of this.keys)e.push(this.values[t]);return e}getLength(){return this.length}}class fe{setupProperties(){this.items=new _e,this.activeItem=null,this.customerDetails={name:"",email:"",phone:""},this.paymentDetails={booking_id:0,gateway_id:"none"},this.coupon=null}constructor(){this.setupProperties()}createItem(e=""){e||(e=G());let t=new be(e);return this.items.push(e,t),this.activeItem=t,t}getItem(e){return this.items.find(e)}getActiveItem(){return this.activeItem}getActiveItemId(){return null!==this.activeItem?this.activeItem.getItemId():""}getItems(){return this.items}getItemsCount(){return this.items.getLength()}setActiveItem(e){this.activeItem="string"==typeof e?this.getItem(e):e}removeItem(e){"string"==typeof e?this.items.remove(e):this.items.remove(e.getItemId())}isEmpty(){return 0===this.getItemsCount()}getProducts(){let e=[];return this.items.forEach((t=>{null!=t.service&&e.push({name:t.service.name,price:t.getPrice(),capacity:t.getCapacity(),quantity_label:t.getService().getQuantityLabel()})})),e}getSubtotalPrice(e=null){null===e&&(e=this.getProducts());let t=0;for(let s of e)t+=s.price;return t}getTotalPrice(e=null){let t=this.getSubtotalPrice(e);if(this.hasCoupon()){let e=this.coupon.calcDiscountAmount(this);return Math.max(0,t-e)}return t}getDeposit(){let e=0;return this.items.forEach((t=>{let s=t.getPrice();this.hasCoupon()&&(s-=this.coupon.calcDiscountForCartItem(t)),e+=t.getDeposit(s)})),e}getCustomer(){return this.customerDetails}getOrder(){let e=this.getProducts(),t={products:e,subtotal:this.getSubtotalPrice(e),total:this.getTotalPrice(e),customer:this.getCustomer()};return this.hasCoupon()&&(t.coupon={code:this.coupon.getCode(),amount:this.coupon.calcDiscountAmount(this)}),t.deposit=this.getDeposit(),t}getPaymentDetails(){return this.paymentDetails}toArray(e="all"){let t={items:[],customer:this.customerDetails};return this.items.forEach((e=>{e.isSet()&&t.items.push(e.toArray())})),C().settings().isPaymentsEnabled()&&(t.payment_details=this.paymentDetails),this.hasCoupon()&&(t.coupon=this.coupon.getCode()),"items"===e?t.items:t}getHash(e="all"){return ye("order"!==e?JSON.stringify(this.toArray(e)):JSON.stringify(this.getOrder()))}didChange(e,t="all"){return e!==this.getHash(t)}setCustomerDetails(e){jQuery.extend(this.customerDetails,e)}setPaymentDetails(e){jQuery.extend(this.paymentDetails,e)}reset(){this.setupProperties()}getMinDate(){let e=null;return this.items.forEach((t=>{t.date&&(!e||e>t.date)&&(e=new Date(t.date.getTime()))})),e||P()}getServiceIds(){let e=this.items.map((e=>null!=e.service?e.service.id:0));return e=l(e),e}updateServices(e){for(let t of e)this.items.forEach((e=>{null!=e.service&&e.service.id===t.id&&(e.service=t)}))}setCoupon(e){this.coupon=e}removeCoupon(){this.coupon=null}hasCoupon(){return null!=this.coupon}testCoupon(){this.hasCoupon()&&!this.coupon.isApplicableForCart(this)&&this.removeCoupon()}}class ve{constructor(e){this.cart=e,this.steps=new _e,this.currentStep=null,this.currentStepId=""}addStep(e){return this.steps.push(e.stepId,e),this}getStep(e){return this.steps.find(e)}mount(e){this.addListeners(e)}addListeners(e){e.children(".mpa-booking-step").on("mpa_booking_step_next",((e,t)=>this.onStep("next",t))).on("mpa_booking_step_back",((e,t)=>this.onStep("back",t))).on("mpa_booking_step_new",((e,t)=>this.onStep("new",t))).on("mpa_reset_booking",((e,t)=>this.onStep("reset",t)))}onStep(e,t){if(!t||!t.step||t.step===this.currentStepId)switch(e){case"next":this.goToNextStep();break;case"back":this.goToPreviousStep();break;case"new":this.goToFirstStep();break;case"reset":this.reset()}}goToNextStep(){if(this.steps.isEmpty())return;let e=this.currentStep?this.steps.findNextKey(this.currentStepId):this.steps.firstKey();e!==this.currentStepId&&(this.switchStep(e),this.skipNextHiddenSteps())}skipNextHiddenSteps(){null!==this.currentStep&&this.currentStep.ready().finally((()=>{this.currentStep.isHiddenStep&&this.currentStep.submit()}))}goToPreviousStep(){if(this.steps.isEmpty())return;let e=this.currentStep?this.steps.findPreviousKey(this.currentStepId):"";e&&e!==this.currentStepId&&(this.switchStep(e),this.skipPreviousHiddenSteps())}skipPreviousHiddenSteps(){null!==this.currentStep&&this.currentStep.ready().finally((()=>{this.currentStep.isHiddenStep&&this.currentStep.cancel()}))}goToFirstStep(){if(this.steps.isEmpty())return;this.cart.createItem(),this.steps.forEach((e=>{"cart item"===e.getCartContext()&&e.reset()}));let e=this.steps.firstKey();this.switchStep(e),this.skipNextHiddenSteps()}goToStep(e){this.switchStep(e)}getFirstVisibleStepId(){let e=null;return this.steps.forEach((t=>{if(!1===t.isHiddenStep)return e=t.stepId,!1})),e}isFirstVisibleStepId(e){return this.getFirstVisibleStepId()===e}switchStep(e){let t=this.steps.find(e);null!=t&&(this.isFirstVisibleStepId(e)&&t.hideButtonBack(),null!=this.currentStep&&this.currentStep.hide(),this.currentStep=t,this.currentStepId=e,t.load(),t.ready().finally((()=>t.show())))}reset(){this.cart.reset(),this.goToFirstStep(),this.steps.forEach((e=>{"cart item"!==e.getCartContext()&&e.reset()}))}}class we{constructor(e,t){this.$element=e,this.cart=t,this.setupProperties(),this.addListeners()}setupProperties(){this.stepId=this.theId(),this.schema=this.propertiesSchema(),this.isActive=!1,this.isLoaded=!1,this.isHiddenStep=!1,this.preventReact=!1,this.preventUpdate=!1,this.hideButtons=!1,this.readyPromise=null,this.$buttons=this.$element.find(".mpa-actions"),this.$buttonBack=this.$buttons.find(".mpa-button-back"),this.$buttonNext=this.$buttons.find(".mpa-button-next")}theId(){return"abstract"}getCartContext(){return"cart"}propertiesSchema(){return{}}addListeners(){this.$buttonBack.on("click",this.cancel.bind(this)),this.$buttonNext.on("click",this.submit.bind(this))}load(){this.isLoaded?this.readyPromise=this.reload():(this.readyPromise=this.loadEntities(),this.isLoaded=!0)}loadEntities(){return Promise.resolve(this)}reload(){return Promise.resolve(this)}reset(){}ready(){return this.readyPromise}isValidInput(){return!1}setProperty(e,t){if(this.preventUpdate)return;let s=this.validateProperty(e,t);if(s===this[e])return;let i=this.preventReact;this.preventReact=!0,this.updateProperty(e,s),i||(this.isActive&&this.react(),this.preventReact=!1)}resetProperty(e){this.setProperty(e)}validateProperty(e,t){let s=t;if(e in this.schema){let i=this.schema[e];if(null==t)s=i.default;else{switch(i.type){case"bool":s=I(t);break;case"integer":s=$(t)}if(!W(s)&&null!=i.options){i.options.indexOf(s)>=0||(s=this[e])}}}else null==t&&(s=null);return s}updateProperty(e,t){let s=this[e];this[e]=t,this.afterUpdate(e,t,s)}afterUpdate(e,t,s){}react(){let e=this.isValidInput();this.$buttonNext.prop("disabled",!e),this.hideButtons&&this.$buttons.toggleClass("mpa-hide",!e)}show(){this.enable(),this.react(),this.$element.removeClass("mpa-hide"),this.readyPromise.finally((()=>this.showReady()))}showReady(){this.$element.addClass("mpa-loaded"),this.hideButtons||this.$buttons.removeClass("mpa-hide")}hide(){this.disable(),this.$element.addClass("mpa-hide")}enable(){this.isActive=!0,this.$buttonBack.prop("disabled",!1),this.$buttonNext.prop("disabled",!1)}disable(){this.isActive=!1,this.$buttonBack.prop("disabled",!0),this.$buttonNext.prop("disabled",!0)}cancel(e){void 0!==e&&e.stopPropagation(),this.isActive&&(this.disable(),this.triggerBack())}submit(e){if(void 0!==e&&e.stopPropagation(),!this.isActive||!this.isValidInput())return;this.disable();let t=this.maybeSubmit();null==t?this.triggerNext():"object"!=typeof t?t?this.triggerNext():this.cancelSubmission():t.then(this.triggerNext.bind(this),this.cancelSubmission.bind(this))}maybeSubmit(){}cancelSubmission(){this.enable(),this.react()}triggerBack(){this.$element.trigger("mpa_booking_step_back",{step:this.stepId})}triggerNext(){this.$element.trigger("mpa_booking_step_next",{step:this.stepId})}hideButtonBack(){this.$buttonBack.prop("disabled",!0),this.$buttonBack.toggleClass("mpa-hide",!0)}}class Ce{static calculateTimezoneOffset(e){if("UTC"===e)return 0;const[t,s]=e.split(":").map(Number);if(isNaN(t)||isNaN(s))throw new Error("Unknown timezone format: "+e);return 60*t+s}static applyTimezoneOffset(e,t){const s=new Date(e);return s.setMinutes(e.getMinutes()-t),s}static isTimezoneProvideByIANA(e){return/^[A-Za-z]+\/[A-Za-z_]+(\/[A-Za-z_]+)?$/.test(e)}static formatDateToCalendar(e){return e.toISOString().replace(/-|:|\.\d{3}/g,"")}static formatDateToCalendarLocal(e){return e.toISOString().replace(/-|:|\.\d{3}|Z/g,"")}static formatDateForOffsetTimeZone(e,t){const s=(new Date).getTimezoneOffset();let i=this.applyTimezoneOffset(e,s);const n=this.calculateTimezoneOffset(t);return i=this.applyTimezoneOffset(i,n),this.formatDateToCalendar(i)}static formatDateForIANATimeZone(e){const t=(new Date).getTimezoneOffset();let s=this.applyTimezoneOffset(e,t);return this.formatDateToCalendarLocal(s)}static formatDateForCalendar(e,t){return this.isTimezoneProvideByIANA(t)?this.formatDateForIANATimeZone(e):this.formatDateForOffsetTimeZone(e,t)}static createICSURL(e,t,s,i,n,a){const o=C().settings().getTimezone();let r=this.formatDateForCalendar(t,o),l=this.formatDateForCalendar(s,o);0===t.getHours()&&0===t.getMinutes()&&0===s.getHours()&&0===s.getMinutes()&&(r=r.replace(/T\d\d\d\d\d\d|Z/g,""),l=l.replace(/T\d\d\d\d\d\d|Z/g,""));const p=["BEGIN:VCALENDAR","VERSION:2.0",`PRODID:${C().settings().getBusinessName()}`];this.isTimezoneProvideByIANA(o)&&p.push("BEGIN:VTIMEZONE","TZID:"+o,"END:VTIMEZONE"),p.push("BEGIN:VEVENT","DTSTAMP:"+this.formatDateToCalendar(new Date),"UID:"+e,"DTSTART"+(this.isTimezoneProvideByIANA(o)?";TZID="+o+":":":")+r,"DTEND"+(this.isTimezoneProvideByIANA(o)?";TZID="+o+":":":")+l,"SUMMARY:"+i,"DESCRIPTION:"+n,"LOCATION:"+a,"END:VEVENT"),p.push("END:VCALENDAR");const m=p.join("\n"),c=new Blob([m],{type:"text/calendar"});return window.URL.createObjectURL(c)}static createGoogleCalendarURL(e,t,s,i,n){const a=new URL("https://www.google.com/calendar/render"),o=C().settings().getTimezone();let r=this.formatDateForCalendar(e,o),l=this.formatDateForCalendar(t,o);return 0===e.getHours()&&0===e.getMinutes()&&0===t.getHours()&&0===t.getMinutes()&&(r=r.replace(/T\d\d\d\d\d\d|Z/g,""),l=l.replace(/T\d\d\d\d\d\d|Z/g,"")),a.search=new URLSearchParams({action:"TEMPLATE",text:s,dates:`${r}/${l}`,details:i,location:n}).toString(),this.isTimezoneProvideByIANA(o)&&a.searchParams.append("ctz",o),a.toString()}static createYahooCalendarURL(e,t,s,i,n){const a=new URL("https://calendar.yahoo.com/"),o=C().settings().getTimezone();let r=this.formatDateForCalendar(e,o),l=this.formatDateForCalendar(t,o),p={v:"60",view:"d",type:"20",title:s,desc:i,in_loc:n};return 0===e.getHours()&&0===e.getMinutes()&&0===t.getHours()&&0===t.getMinutes()?(p.st=r.replace(/T\d\d\d\d\d\d|Z/g,""),p.dur="allday"):(p.st=r,p.et=l),a.search=new URLSearchParams(p).toString(),a.toString()}}class Se{constructor(e,t){this.cart=t,this.$bookingDetailsSection=e,this.$bookingCartItems=this.$bookingDetailsSection.find(".booking-reservations"),this.$bookingCartItem=this.$bookingCartItems.find(".reservation"),this.$addToCalendarGoogle=this.$bookingCartItem.find(".mpa-add-to-calendar-link--google"),this.$addToCalendarApple=this.$bookingCartItem.find(".mpa-add-to-calendar-link--apple"),this.$addToCalendarOutlook=this.$bookingCartItem.find(".mpa-add-to-calendar-link--outlook"),this.$addToCalendarYahoo=this.$bookingCartItem.find(".mpa-add-to-calendar-link--yahoo")}assignURL(e,t){e.attr("href",t)}initBookingCart(){this.$bookingCartItems.empty(),wp.hooks.doAction("mpa_booking_details_section_init",this.$bookingDetailsSection,this.cart),this.cart.items.forEach((e=>{let t=this.$bookingCartItem.clone();this.$bookingCartItems.append(t);const s=e.getService(),i=s.getName(),n=e.employee.name+". "+s.getQuantityLabel()+": "+e.getCapacity()+".";let a=i;e.getCapacity()>1&&(a+=" ",a+='<span class="mpa-reservation-capacity">',a+=s.getQuantityLabel()+": "+e.getCapacity(),a+="</span>"),t.find(".reservation-title").html(a),t.find(".reservation-date").html(E(e.date)),t.find(".reservation-time").html(e.time.toString());const o=Ce.createICSURL(e.getItemId(),e.time.startTime,e.time.endTime,i,n,e.location.name),r=Ce.createGoogleCalendarURL(e.time.startTime,e.time.endTime,i,n,e.location.name),l=Ce.createYahooCalendarURL(e.time.startTime,e.time.endTime,i,n,e.location.name);this.assignURL(t.find(".mpa-add-to-calendar-link--google"),r),this.assignURL(t.find(".mpa-add-to-calendar-link--apple"),o),this.assignURL(t.find(".mpa-add-to-calendar-link--outlook"),o),this.assignURL(t.find(".mpa-add-to-calendar-link--yahoo"),l)})),this.$bookingDetailsSection.toggleClass("mpa-hide",!1)}reset(){this.$bookingDetailsSection.toggleClass("mpa-hide",!0);const e="#";this.assignURL(this.$addToCalendarGoogle,e),this.assignURL(this.$addToCalendarApple,e),this.assignURL(this.$addToCalendarOutlook,e),this.assignURL(this.$addToCalendarYahoo,e)}}class Ee extends we{setupProperties(){super.setupProperties(),this.hideButtons=!0,this.isPosted=!1,this.isBooked=!1,this.$message=this.$element.find(".mpa-message").first(),this.$buttonReset=this.$buttons.find(".mpa-button-reset"),this.$bookingDetails=this.$element.find(".mpa-booking-details").first(),this.$bookingDetails.length>0&&(this.bookingDetails=new Se(this.$bookingDetails,this.cart))}reload(){return this.isPosted=!1,this.isBooked=!1,this.setMessage(h("Making a reservation...","motopress-appointment")+' <span class="mpa-preloader"></span>'),this.bookingDetails&&this.bookingDetails.reset(),Promise.resolve(this)}addListeners(){super.addListeners(),this.$buttonReset.on("click",this.resetForm.bind(this))}theId(){return"booking"}react(){this.isPosted&&(this.$buttons.removeClass("mpa-hide"),this.$buttonBack.toggleClass("mpa-hide",this.isBooked),this.$buttonReset.toggleClass("mpa-hide",!this.isBooked||this.isRedirectNeeded()))}show(){super.show(),this.createBooking()}createBooking(){f("/bookings",wp.hooks.applyFilters("mpa_booking_cart_data",this.cart.toArray())).then((e=>{this.isRedirectNeeded()?this.redirectPayment():(this.isPosted=this.isBooked=!0,this.cart.paymentDetails.booking_id=e.booking_id,this.setMessage(e.message),this.bookingDetails&&this.bookingDetails.initBookingCart(),this.react())}),(e=>{this.isPosted=!0,this.setMessage(e.message),this.react()}))}showReady(){super.showReady(),this.$buttonBack.addClass("mpa-hide"),this.$buttonReset.addClass("mpa-hide")}setMessage(e){this.$message.html(e)}redirectPayment(){this.setMessage(h("You will be redirected to a secure page to complete the payment.","motopress-appointment"));let e=this.cart.getPaymentDetails();window.location.href=e.redirect_url}isRedirectNeeded(){let e=this.cart.getPaymentDetails();return"redirect_url"in e&&""!=e.redirect_url}resetForm(e){e.preventDefault(),this.isPosted&&this.isBooked&&this.$element.trigger("mpa_reset_booking")}}function ke(e){let t="";for(let s in e)t+=" "+s+'="'+e[s]+'"';return t}function Pe(e,t={}){return"<button"+ke(t=jQuery.extend({},{type:"button",class:"button"},t))+">"+e+"</button>"}function Te(e,t){let s={service_id:".mpa-service-id",service_name:".mpa-service-name",service_thumbnail:".mpa-service-thumbnail",employee_id:".mpa-employee-id",employee_name:".mpa-employee-name",location_id:".mpa-location-id",location_name:".mpa-location-name",reservation_date:".mpa-reservation-date",reservation_save_date:".mpa-reservation-save-date",reservation_time:".mpa-reservation-time",reservation_period:".mpa-reservation-period",reservation_save_period:".mpa-reservation-save-period",reservation_capacity:".mpa-reservation-capacity",reservation_clients:".mpa-reservation-clients",reservation_clients_count:".mpa-reservation-clients-count",reservation_price:".mpa-reservation-price"},i=t.clone();i.attr("data-id",e.getItemId());let n=e.getCapacityOptions();for(let t in s){let a=s[t],o=i.find(a).first(),r="{"+t+"}";if(!(o.length>0?o.html():"").includes(r))continue;let l="";switch(t){case"service_id":l=e.service.id;break;case"service_name":l=e.service.name;break;case"service_thumbnail":l=Le(e.service.thumbnail);break;case"employee_id":l=e.employee.id;break;case"employee_name":l=e.employee.name;break;case"location_id":l=e.location.id;break;case"location_name":l=e.location.name;break;case"reservation_date":l=E(e.date);break;case"reservation_save_date":l=E(e.date,"internal");break;case"reservation_time":l=e.time.toString("short");break;case"reservation_period":l=e.time.toString();break;case"reservation_save_period":l=e.time.toString("internal");break;case"reservation_capacity":l=xe(m(n,n),e.capacity);break;case"reservation_clients":l=Ae(m(n,n),e.capacity);break;case"reservation_clients_count":l=e.capacity;break;case"reservation_price":let t=e.employee.id;l=$e(e.service.getPrice(t,e.capacity))}o.html(o.html().replace(r,l))}return i.find(".cell-people .cell-title").html(e.getService().getQuantityLabel()),i.find('[name*="{item_id}"]').each(((t,s)=>{s.name=s.name.replace("{item_id}",e.getItemId())})),1===n.length&&i.find(".cell-people").addClass("mpa-hide"),i}function Ie(e){let t="";t+='<table class="mpa-order widefat">',t+="<tbody>";for(let s of e.products)t+='<tr class="mpa-order-service">',t+='<td class="column-service">',t+='<span class="mpa-service-name">'+s.name+"</span>",s.capacity>1&&(t+='<span class="mpa-reservation-capacity">',t+=s.quantity_label+": "+s.capacity,t+="</span>"),t+="</td>",t+='<td class="column-price">'+De(s.price)+"</td>",t+="</tr>";return t+='<tr class="mpa-order-subtotal">',t+='<th class="column-subtotal">'+h("Subtotal","motopress-appointment")+"</th>",t+='<th class="column-price">'+De(e.subtotal)+"</th>",t+="</tr>",t+="</tbody>",t+="<tfoot>",e.coupon&&(t+='<tr class="mpa-order-coupon">',t+='<th class="column-coupon">',t+=h("Coupon: %s","motopress-appointment").replace("%s",e.coupon.code),t+="</th>",t+='<td class="column-price">',t+=De(-e.coupon.amount),t+=" ",t+='<a href="#" class="mpa-remove-coupon">'+h("Remove","motopress-appointment")+"</a>",t+="</td>",t+="</tr>"),t+='<tr class="mpa-order-total">',t+='<th class="column-total">'+h("Total","motopress-appointment")+"</th>",t+='<th class="column-price">'+De(e.total)+"</th>",t+="</tr>",t+="</tfoot>",t+="</table>",t}function $e(e,t={}){let s=C().settings();t=jQuery.extend({currency_symbol:s.getCurrencySymbol(),currency_position:s.getCurrencyPosition(),decimal_separator:s.getDecimalSeparator(),thousand_separator:s.getThousandSeparator(),decimals:s.getDecimalsCount(),literal_free:!0,trim_zeros:!0},t);let i=function(e,t=0,s=".",i=","){let n,a,o,r,l,p="";return e<0&&(p="-",e*=-1),n=parseInt(e=(+e||0).toFixed(t))+"",(a=n.length)>3?a%=3:a=0,l=a?n.substr(0,a)+i:"",o=n.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+i),r=t?s+Math.abs(e-n).toFixed(t).replace(/-/,0).slice(2):"",p+l+o+r}(Math.abs(e),t.decimals,t.decimal_separator,t.thousand_separator),n="mpa-price";if(0==e&&(n+=" mpa-zero-price"),0==e&&t.literal_free)n+=" mpa-price-free",i=d("Free","Zero price","motopress-appointment");else{t.trim_zeros&&(i=function(e,t=null){null==t&&(t=C().settings().getDecimalSeparator());let s=new RegExp("\\"+t+"0+$");return e.replace(s,"")}(i));let s='<span class="mpa-currency">'+t.currency_symbol+"</span>";switch(t.currency_position){case"before":i=s+i;break;case"after":i+=s;break;case"before_with_space":i=s+"&nbsp;"+i;break;case"after_with_space":i=i+"&nbsp;"+s}e<0&&(i="-"+i)}return'<span class="'+n+'">'+i+"</span>"}function De(e,t={}){return t.literal_free=!1,$e(e,t)}function xe(e,t,s={}){let i="<select"+ke(s)+">";return i+=Ae(e,t),i+="</select>",i}function Me(e,t,s=!1){let i="";return i='<option value="'+e+'"'+(s?' selected="selected"':"")+">",i+=t,i+="</option>",i}function Ae(e,t){let s="";for(let i in e)s+=Me(i,e[i],i==t);return s}function Be(e,t,s,i){let n=Ae(t,i)+Ae(s,i);e.empty().append(n).val(i)}function Le(e){let{width:t,height:s}=C().settings().getThumbnailSize();return"<img"+ke({width:t,height:s,src:e,class:"attachment-thumbnail size-thumbnail"})+">"}class Fe extends we{setupProperties(){super.setupProperties(),this.isBeginCheckoutEventSent=!1,this.$cart=this.$element.find(".mpa-cart"),this.$items=this.$cart.find(".mpa-cart-items"),this.$itemTemplate=this.$cart.find(".mpa-cart-item-template"),this.$noItems=this.$element.find(".no-items"),this.$totalPrice=this.$element.find(".mpa-cart-total-price"),this.$buttonNew=this.$buttons.find(".mpa-button-new")}theId(){return"cart"}addListeners(){super.addListeners(),this.$buttonNew.on("click",this.createNew.bind(this))}load(){if(this.$itemTemplate.remove(),this.$itemTemplate.removeClass("mpa-cart-item-template"),null!==this.cart.getActiveItem()){let e=this.cart.getActiveItem(),t=e.getItemId(),s=e.getDate(),i=e.getTime();this.cart.getItems().forEach((n=>{n.isSet()&&n.getItemId()!=t&&n.isAtTime(s,i)&&n.removeBookingVariatForEmployee(e.getEmployeeId())}))}this.updateActiveItemCapacity(),this.refreshCart(),this.isLoaded=!0,this.readyPromise=Promise.resolve(this)}reset(){this.$items.find(".mpa-cart-item").remove(),this.$noItems.removeClass("mpa-hide"),this.isBeginCheckoutEventSent=!1}updateActiveItemCapacity(){let e=this.cart.getActiveItem();if(!e)return;let t=e.getMinCapacity(),s=e.getMaxCapacity();var i,n,a;e.setCapacity((i=e.getCapacity(),n=t,a=s,Math.max(n,Math.min(i,a))))}refreshCart(){this.cart.getActiveItemId(),this.cart.items.forEach(((e,t,s)=>{let i='.mpa-cart-item[data-id="'+s+'"]',n=this.$items.find(i);0===n.length?(n=this.addItem(e),this.bindListeners(n)):(n=this.updateItem(n,e),this.bindListeners(n))})),this.updateTotalPrice()}addItem(e){let t=Te(e,this.$itemTemplate);return this.$items.append(t),this.$noItems.addClass("mpa-hide"),t}updateItem(e,t){let s=Te(t,this.$itemTemplate);return e.replaceWith(s),s}bindListeners(e){let t=e.data("id"),s=this.cart.getItem(t),i=e.find(".mpa-reservation-capacity select, .mpa-reservation-clients select"),n=e.find(".mpa-reservation-price"),a=e.find(".mpa-button-remove, .mpa-button-edit-or-remove"),o=e.find(".mpa-button-edit, .mpa-button-edit-or-remove");i.on("change",(t=>{let i=$(t.target.value);s.setCapacity(i);let a=s.getBookingVariantForCapacity(i),o=a.employeeId,r=a.locationId;if(s.getEmployeeId()!=o)s.setEmployee(o,!1),s.setLocation(r,!1),e=this.updateItem(e,s),this.bindListeners(e);else{let e=s.service.getPrice(o,i);n.html($e(e))}this.updateTotalPrice()})),this.isMultibookingEnabled()&&a.on("click",(s=>{s.stopPropagation(),e.remove();let i=this.cart.getItem(t);this.cart.removeItem(t),this.cart.isEmpty()&&this.$noItems.removeClass("mpa-hide"),this.updateTotalPrice(),this.react(),document.dispatchEvent(new CustomEvent("mpa_remove_from_cart",{detail:{cartItem:i,currencyCode:C().settings().getCurrency()}}))})),this.isMultibookingEnabled()||o.on("click",(()=>{this.cart.setActiveItem(t),this.cancel()}))}updateTotalPrice(){this.$totalPrice.html(De(this.cart.getTotalPrice()))}isMultibookingEnabled(){return C().settings().isMultibookingEnabled()}isValidInput(){return!this.cart.isEmpty()}createNew(){this.isActive&&(this.disable(),this.triggerNew())}triggerNew(){this.$element.trigger("mpa_booking_step_new",{step:this.stepId})}maybeSubmit(){this.isBeginCheckoutEventSent||(document.dispatchEvent(new CustomEvent("mpa_begin_checkout",{detail:{cart:this.cart,currencyCode:C().settings().getCurrency()}})),this.isBeginCheckoutEventSent=!0)}}class Re{constructor(e,t){this.cart=t,this.$element=e,this.$couponCode=e.find('[name="coupon_code"]'),this.$applyButton=e.find(".mpa-apply-coupon-button"),this.$messageHolder=e.find(".mpa-message-wrapper"),this.$preloader=e.find(".mpa-preloader"),this.$parentForm=e.parents(".mpa-booking-step").first(),this.addListeners(),this.reset()}addListeners(){this.$couponCode.on("keydown",(e=>{"Enter"===e.code&&this.onEnter(e)})),this.$applyButton.on("click",this.onSubmit.bind(this))}onEnter(e){e.preventDefault(),e.stopPropagation(),this.applyCouponCode(e.target.value)}onSubmit(e){e.preventDefault(),e.stopPropagation(),this.applyCouponCode(this.$couponCode.val())}applyCouponCode(e){this.clearMessage(),e?(this.pauseAll(),z().coupon().findByCode(e).then((e=>{e.isApplicableForCart(this.cart)?(this.cart.setCoupon(e),this.reset(),this.triggerApplied(e),this.setMessage(h("Coupon code applied successfully.","motopress-appointment"))):this.setMessage(h("Sorry, your booking is not eligible for this coupon.","motopress-appointment")),this.unpauseAll()}),(e=>{this.setMessage(e.message),this.unpauseAll()}))):this.setMessage(h("Coupon code is empty.","motopress-appointment"))}reset(){this.$couponCode.val(""),this.clearMessage(),0===this.cart.getTotalPrice()?(this.disable(),this.$element.addClass("mpa-hide")):(this.enable(),this.$element.removeClass("mpa-hide"))}disable(){this.$couponCode.prop("disabled",!0),this.$applyButton.prop("disabled",!0)}enable(){this.$couponCode.prop("disabled",!1),this.$applyButton.prop("disabled",!1)}pauseAll(){this.disable(),this.showPreloader(),this.$parentForm.trigger("mpa_booking_step_disable")}unpauseAll(){this.enable(),this.hidePreloader(),this.$parentForm.trigger("mpa_booking_step_enable")}triggerApplied(e){this.$parentForm.trigger("mpa_booking_coupon_applied",{coupon:e})}setMessage(e){this.$messageHolder.html(e).removeClass("mpa-hide")}clearMessage(){this.$messageHolder.html("").addClass("mpa-hide")}showPreloader(){this.$preloader.removeClass("mpa-hide")}hidePreloader(){this.$preloader.addClass("mpa-hide")}}function Oe(e){const t=jQuery("<span/>",{id:e.attr("id")+"_error",class:"mpa-phone-field-error mpa-hide",text:h("Phone number is invalid.","motopress-appointment")});e.after("<br>",t);const s=n(e[0],{separateDialCode:!0,initialCountry:i.settings.country,hiddenInput:e.attr("name"),utilsScript:i.urls.plugin+"assets/js/intl-tel-input-17.0.19/js/utils.js"});s.promise.then((()=>{e.val()&&a(),e.on("countrychange",(e=>{a()})),e.on("input",(e=>{a()}))}));const a=()=>{s.isValidNumber()?(jQuery("input[type='hidden'][name='"+e.attr("name")+"']").val(s.getNumber(intlTelInputUtils.numberFormat.E164)),e.removeClass("mpa-phone-number--invalid"),t.addClass("mpa-hide")):(e.addClass("mpa-phone-number--invalid"),t.removeClass("mpa-hide"))};return s}window.mpa_intl_tel_input=Oe;class Ne extends we{setupProperties(){super.setupProperties(),this.name="",this.email="",this.phone="",this.notes="",this.acceptTerms=!1,this.createAccount=!1,this.$checkoutForm=this.$element.find(".mpa-checkout-form"),this.$name=this.$element.find(".mpa-customer-name"),this.$email=this.$element.find(".mpa-customer-email"),this.$phone=this.$element.find(".mpa-customer-phone"),this.$notes=this.$element.find(".mpa-customer-notes"),this.$order=this.$element.find(".mpa-order"),wp.hooks.doAction("mpa_step_checkout_form",this.$checkoutForm),0!==this.$phone.length&&(this.phoneValidator=Oe(this.$phone)),C().settings().getTermsPageIdForAcceptance()&&(this.$acceptTerms=this.$element.find(".mpa-accept-terms")),this.$messageHolder=this.$element.find(".mpa-message").first(),this.$preloader=this.$element.find(".mpa-loading"),C().settings().isAllowCustomerAccountCreation()&&(this.$createAccount=this.$element.find(".mpa-customer-create-account"),this.$createAccountDescription=this.$element.find(".mpa-customer-create-account-description"),this.setProperty("createAccount",this.$createAccount.prop("checked"))),i&&i.currentCustomer&&i.currentCustomer.name&&(this.setProperty("name",i.currentCustomer.name),this.$name.val(i.currentCustomer.name)),i&&i.currentCustomer&&i.currentCustomer.email&&(this.setProperty("email",i.currentCustomer.email),this.$email.val(i.currentCustomer.email)),i&&i.currentCustomer&&"undefined"!==i.currentCustomer.phone&&(this.setProperty("phone",i.currentCustomer.phone),this.phoneValidator.setNumber(i.currentCustomer.phone),this.$phone.trigger("input")),this.service=null,this.couponSection=null}theId(){return"checkout"}propertiesSchema(){return{name:{type:"string",default:""},email:{type:"string",default:""},phone:{type:"string",default:""},notes:{type:"string",default:""},acceptTerms:{type:"bool",default:!1},$createAccount:{type:"bool",default:!1}}}addListeners(){super.addListeners(),this.$checkoutForm.on("submit",(e=>!1)),this.$name.on("input",(e=>this.setProperty("name",e.target.value))),this.$email.on("input",(e=>this.setProperty("email",e.target.value))),this.$phone.on("input",(e=>{this.setProperty("phone",""),this.phoneValidator.isValidNumber()&&this.setProperty("phone",this.phoneValidator.getNumber(intlTelInputUtils.numberFormat.E164))})),this.$phone.on("countrychange",(e=>{this.setProperty("phone",""),this.phoneValidator.isValidNumber()&&this.setProperty("phone",this.phoneValidator.getNumber(intlTelInputUtils.numberFormat.E164))})),this.$notes.on("input",(e=>this.setProperty("notes",e.target.value))),C().settings().getTermsPageIdForAcceptance()&&this.$acceptTerms.on("input",(e=>this.setProperty("acceptTerms",e.target.checked))),C().settings().isAllowCustomerAccountCreation()&&this.$createAccount.on("input",(e=>{this.setProperty("createAccount",e.target.checked),e.target.checked?this.$createAccountDescription.removeClass("mpa-hide"):this.$createAccountDescription.addClass("mpa-hide")})),this.$element.on("mpa_booking_step_disable",this.disable.bind(this)),this.$element.on("mpa_booking_step_enable",this.enable.bind(this)),this.$element.on("mpa_booking_coupon_applied",(()=>this.updateOrder()))}load(){this.couponSection?this.couponSection.reset():C().settings().isCouponsEnabled()&&(this.couponSection=new Re(this.$element.find(".mpa-coupon-details"),this.cart)),this.cart.hasCoupon()&&this.cart.testCoupon(),this.updateOrder(),this.isLoaded=!0,this.readyPromise=Promise.resolve(this)}reset(){wp.hooks.doAction("mpa_step_checkout_reset",this.$checkoutForm),this.$notes.val(""),this.resetProperty("notes"),C().settings().getTermsPageIdForAcceptance()&&(this.$acceptTerms.prop("checked",!1),this.resetProperty("acceptTerms")),C().settings().isAllowCustomerAccountCreation()&&(this.clearMessage(),this.$createAccount.prop("checked",!1),this.resetProperty("createAccount")),this.couponSection&&this.couponSection.reset()}updateOrder(){if(0===this.$order.length)return;this.$order.empty(),this.$order.html(Ie(this.cart.getOrder()));let e=this.$order.find(".mpa-remove-coupon");e.length>0&&e.on("click",this.removeCoupon.bind(this))}removeCoupon(e){e.preventDefault(),e.stopPropagation(),this.cart.removeCoupon(),this.couponSection.clearMessage(),this.updateOrder()}isValidInput(){return this.isValidName()&&this.isValidEmail()&&this.isValidPhone()&&this.isValidAcceptTerms()&&wp.hooks.applyFilters("mpa_step_checkout_form_valid",!0,this.$checkoutForm)}isValidName(){return!(this.$name.length>0&&this.$name.is("[required]"))||""!==this.name}isValidEmail(){return!(this.$email.length>0&&this.$email.is("[required]"))||""!==this.email&&!!this.email.match(/.+@.+/)}isValidPhone(){return!(this.$phone.length>0&&this.$phone.is("[required]"))||this.phoneValidator.isValidNumber()}isValidAcceptTerms(){return!C().settings().getTermsPageIdForAcceptance()||C().settings().isPaymentsEnabled()||this.acceptTerms}react(){super.react(),this.$buttonNext.prop("disabled",!1)}setMessage(e){this.$messageHolder.html(e).removeClass("mpa-hide")}clearMessage(){this.$messageHolder.html("").addClass("mpa-hide")}showPreloader(){this.$preloader.removeClass("mpa-hide")}hidePreloader(){this.$preloader.addClass("mpa-hide")}async maybeSubmit(){if(wp.hooks.hasFilter("mpa_step_checkout_maybe_submit")&&await wp.hooks.applyFilters("mpa_step_checkout_maybe_submit",{},this.$checkoutForm),this.couponSection&&this.couponSection.disable(),this.cart.setCustomerDetails({name:this.name,email:this.email,phone:this.phone,notes:this.notes,acceptTerms:this.acceptTerms}),this.createAccount&&""!==this.email){this.showPreloader();return f("/customers/create",{name:this.name,email:this.email,phone:this.phone}).then((e=>{this.hidePreloader(),this.clearMessage()}),(e=>{throw this.hidePreloader(),this.setMessage(e),e}))}}}class He{setupProperties(){this.gatewayId="basic",this.settings=this.getDefaults(),this.$mountWrapper=null,this.loadPromise=null,this.isEnabled=!1,this.isMounted=!1,this.haveErrors=!1}constructor(e,t){this.setupProperties(),this.$mountWrapper=e,this.cart=t}load(){return this.addListeners(),this.loadPromise=Promise.resolve(this),this.loadPromise}addListeners(){}onCartChange(e){}mount(e){}ready(){return this.loadPromise}enable(){this.isEnabled||(this.isMounted||(this.mount(this.$mountWrapper),this.isMounted=!0),this.$mountWrapper.removeClass("mpa-hide"),this.isEnabled=!0)}disable(){this.isEnabled&&(this.$mountWrapper.addClass("mpa-hide"),this.isEnabled=!1)}isValid(){return!this.haveErrors}processPayment(e,t){return f("/payments/prepare",{payment_details:e.paymentDetails})}getDefaults(){return{country:C().settings().getCountry(),redirect_url:{payment_received:C().settings().getReservationReceivedPageUrl(),failed_transaction:C().settings().getFailedTransactionPageUrl()}}}reset(){}}class Ve extends He{enable(){}}class ze{setupProperties(){this.methods=null,this.uid="",this.paymentMethods=new _e,this.selectedMethod="",this.$mountWrapper=null,this.$errorsWrapper=null,this.$gatewayPreloader=null,this.mountedMethods=[]}constructor(e){this.setupProperties(),this.methods=e,this.uid=G(),this.addPaymentMethods(this.methods)}mountedMethod(){let e=!1;Object.entries(this.mountedMethods).forEach(((t,s)=>{s||(e=!0)})),e&&this.$gatewayPreloader.addClass("mpa-hide")}addPaymentMethods(e){for(const t in e)this.paymentMethods.includesKey(t)||(this.paymentMethods.push(t,{$nav:null,$fields:null}),this.selectedMethod||(this.selectedMethod=t))}isMounted(){return null!==this.$mountWrapper}mount(e){e.append(this.render()),this.$gatewayPreloader=e.parent().find(".mpa-payment-gateway-title .mpa-preloader"),this.$gatewayPreloader.removeClass("mpa-hide"),this.paymentMethods.forEach(((t,s,i)=>{t.$nav=e.find(".mpa-stripe-payment-method."+i),t.$fields=e.find(".mpa-stripe-payment-fields."+i);const n=this.methods[i].getControl();if(null!==n){const e=this.getElementSelector(i);this.mountedMethods[i]=!1,n.mount(e),n.on("ready",(t=>{this.mountedMethod(t),document.querySelector(e).classList.remove("mpa-preloader-skeleton-pulsate")}))}"card"===i&&this.methods.card.isCanMakePaymentRequest().then((e=>{const t=this.getElementSelector("payment-request-button"),s=document.querySelector(t);s&&(e?(this.mountedMethods.payment_request_button=!1,this.methods.card.paymentRequestButton.mount(t),this.methods.card.paymentRequestButton.on("ready",(e=>{this.mountedMethod("payment_request_button"),s.classList.remove("mpa-preloader-skeleton-pulsate")}))):(s.classList.add("mpa-hide"),document.querySelector(".mpa-stripe-payment-request-button-separator").classList.add("mpa-hide")))}))})),e.find('input[name="stripe_payment_method"]').on("change",this.onPaymentMethodChange.bind(this)),this.$mountWrapper=e,this.$errorsWrapper=e.find(".mpa-errors")}onPaymentMethodChange(e){let t=null;switch(this.selectedMethod){case"payment":case"card":case"ideal":case"sepa_debit":t=this.methods[this.selectedMethod].getControl()}null!==t&&t.clear(),this.selectPaymentMethod(e.target.value)}selectPaymentMethod(e){e!==this.selectedMethod&&(this.togglePaymentMethod(this.selectedMethod,!1),this.togglePaymentMethod(e,!0),this.selectedMethod=e)}togglePaymentMethod(e,t){if(this.isMounted()&&this.paymentMethods.includesKey(e)){let s=this.paymentMethods.find(e);s.$nav.toggleClass("active",t),s.$fields.toggleClass("mpa-hide",!t)}}getElementSelector(e){return"sepa_debit"===e&&(e="iban"),"#mpa-stripe-"+e+"-element-"+this.uid}render(){let e="";e+='<section class="mpa-stripe-payment-container">',this.paymentMethods.length>1&&(e+=this.renderNavigation());for(let t of this.paymentMethods.keys)e+=this.renderFields(t);return e+='<div class="mpa-errors"></div>',e+="</section>",e}renderNavigation(){let e="";e+='<nav class="mpa-stripe-payment-methods">',e+="<ul>";for(let t of this.paymentMethods.keys){let s=t===this.selectedMethod;e+='<li class="mpa-stripe-payment-method '+t+(s?" active":"")+'">',e+="<label>",e+='<input type="radio" name="stripe_payment_method" value="'+t+'"'+(s?' checked="checked"':"")+">",e+=" "+this.methods[t].title,e+="</label>",e+="</li>"}return e+="</ul>",e+="</nav>",e}renderFields(e){let t="";switch(t+='<div class="mpa-stripe-payment-fields '+e+(e===this.selectedMethod?"":" mpa-hide")+'">',t+="<fieldset>",e){case"payment":t+=this.renderPaymentFields();break;case"card":t+=this.renderCardFields();break;case"ideal":t+=this.renderIdealFields();break;case"sepa_debit":t+=this.renderSepaDebitFields();break;default:t+=this.renderRedirectNotice()}return t+="</fieldset>","sepa_debit"===e&&(t+='<p class="notice">',t+=h("By providing your IBAN and confirming this payment, you authorise (A) %s and Stripe, our payment service provider, to send instructions to your bank to debit your account and (B) your bank to debit your account in accordance with those instructions. You are entitled to a refund from your bank under the terms and conditions of your agreement with your bank. A refund must be claimed within 8 weeks starting from the date on which your account was debited.","motopress-appointment").replace("%s",C().settings().getBusinessName()),t+="</p>"),t+="</div>",t}renderPaymentFields(){let e="";return e+='<div id="mpa-stripe-payment-element-'+this.uid+'" class="mpa-stripe-element mpa-stripe-payment-element"></div>',e}renderCardFields(){let e="";return e+='<label for="mpa-stripe-card-element-'+this.uid+'">',e+=h("Credit or debit card","motopress-appointment"),e+="</label>",this.methods.card.isEnabledWallets()&&(e+='<div id="mpa-stripe-payment-request-button-element-'+this.uid+'" class="mpa-stripe-element mpa-stripe-payment-request-button-element mpa-preloader-skeleton-pulsate StripeElement"></div>',e+='<div class="mpa-stripe-payment-request-button-separator">'+h("or","motopress-appointment")+"</div>"),e+='<div id="mpa-stripe-card-element-'+this.uid+'" class="mpa-stripe-element mpa-stripe-card-element mpa-preloader-skeleton-pulsate"></div>',e}renderIdealFields(){let e="";return e+='<label for="mpa-stripe-ideal-element-'+this.uid+'">',e+=h("Select iDEAL Bank","motopress-appointment"),e+="</label>",e+='<div id="mpa-stripe-ideal-element-'+this.uid+'" class="mpa-stripe-element mpa-stripe-ideal-element mpa-preloader-skeleton-pulsate"></div>',e}renderSepaDebitFields(){let e="";return e+='<label for="mpa-stripe-iban-element-'+this.uid+'">',e+=h("IBAN","motopress-appointment"),e+="</label>",e+='<div id="mpa-stripe-iban-element-'+this.uid+'" class="mpa-stripe-element mpa-stripe-iban-element mpa-preloader-skeleton-pulsate"></div>',e}renderRedirectNotice(){let e="";return e+='<p class="notice">',e+=h("You will be redirected to a secure page to complete the payment.","motopress-appointment"),e+="</p>",e}showError(e){this.isMounted()&&this.$errorsWrapper.html(e).removeClass("mpa-hide")}hideErrors(){this.isMounted()&&this.$errorsWrapper.addClass("mpa-hide").html("")}reset(){let e=this.paymentMethods.firstKey();this.selectPaymentMethod(e)}}class qe extends He{load(){return this.loadPromise=_("/payments/settings",{gateway_id:this.gatewayId}).catch((e=>console.error(e.message)||{})).then((e=>(jQuery.extend(this.settings,e),this))),this.loadPromise}}class Ue{name=null;title=null;control=null;api=null;elements=null;constructor(e,t,s){if(this.api=e,this.settings=s,this.elements=t,new.target===Ue)throw new Error("Cannot construct Abstract instances directly");if(void 0===this.setupProperties)throw new Error("Must override method: setupProperties()");if(this.setupProperties(),null===this.name||void 0===this.name)throw new Error('"name" must be defined in a non-abstract payment method class');if(null===this.title||void 0===this.title)throw new Error('"title" must be defined in a non-abstract payment method class')}createControl(){return null}getControl(){return this.control||(this.control=this.createControl()),this.control}reset(){null!==this.control&&this.control.clear()}createPaymentMethodData(e,t,s){let i={type:this.name,billing_details:{name:e.padEnd(3," "),email:t,phone:s}};return null!==this.control&&(i[this.name]=this.control),i}createPaymentMethod(e){return this.api.createPaymentMethod(e)}confirmPayment(e,t){throw new Error("Abstract Method has no implementation")}processPayment(e,t,s){const i=e.getCustomer(),n=this.createPaymentMethodData(i.name,i.email,i.phone);return this.createPaymentMethod(n).then((t=>{if(t.error)throw new Error(t.error.message);return f("/payments/prepare",{payment_details:jQuery.extend(e.paymentDetails,{payment_method_id:t.paymentMethod.id})})})).then((({client_secret:e,return_url:t})=>this.confirmPayment(e,t).then((e=>{if(e.error)throw new Error(e.error.message);return e.paymentIntent})))).then((e=>{let t={payment_method:this.name,payment_intent_id:e.id};return"requires_action"==e.status&&"redirect_to_url"==e.next_action.type&&(t.redirect_url=e.next_action.redirect_to_url.url),t})).catch((e=>{throw console.error("Unable to process payment.",e.message),null!=s.error_handler&&s.error_handler(e.message),e}))}}class je extends Ue{setupProperties(){this.name="payment",this.title=h("Payment methods","motopress-appointment"),this.customerDetails={name:"",email:"",phone:""}}provideCart(e){this.cart=e}getCustomerDetails(){return this.cart?this.cart.getCustomer():{name:"",email:"",phone:""}}confirmPayment(e,t){const s=this.getCustomerDetails(),i=this.elements;return new Promise(((e,t)=>{i.submit().then((({error:s})=>{if(s){const e=s.message||"";t(new Error(e))}else e()})).catch((e=>{t(e)}))})).then((()=>{var n,a,o;return this.api.confirmPayment({elements:i,clientSecret:e,confirmParams:{payment_method_data:{billing_details:{name:null!==(n=s?.name)&&void 0!==n?n:null,email:null!==(a=s?.email)&&void 0!==a?a:null,phone:null!==(o=s?.phone)&&void 0!==o?o:null,address:{line1:null,line2:null,city:null,state:null,country:null,postal_code:null}}},return_url:t},redirect:"if_required"})})).catch((e=>{throw console.error("Error during payment confirmation:",e),e}))}processPayment(e,t,s){return f("/payments/prepare",{payment_details:e.paymentDetails}).then((({client_secret:e,return_url:t})=>this.confirmPayment(e,t).then((e=>{if(e.error)throw new Error(e.error.message);return e.paymentIntent})))).then((e=>{let t={payment_method:this.name,payment_intent_id:e.id};if("requires_action"===e.status){if("redirect_to_url"!==e.next_action.type)throw new Error("The user has cancelled or failed to complete the payment.");t.redirect_url=e.next_action.redirect_to_url.url}return t})).catch((e=>{if(e.message)throw console.error("Unable to process payment.",e.message),e;throw new Error("Unable to process payment.")}))}createControl(){const e=this.getCustomerDetails();return this.elements.create("payment",{defaultValues:{billingDetails:{address:{country:this.settings.country}}},fields:{billingDetails:{name:e?.name?"never":"auto",email:e?.email?"never":"auto",phone:e?.phone?"never":"auto",address:{line1:"auto",line2:"auto",city:"auto",state:"auto",country:"auto",postalCode:"auto"}}}})}}class We extends Ue{setupProperties(){this.name="card",this.title=h("Card","motopress-appointment"),this.paymentRequestButtonEvent=null,this.canMakePaymentRequest=Promise.resolve(null),this.isEnabledWallets()&&(this.paymentRequest=this.createPaymentRequest(),this.canMakePaymentRequest=this.paymentRequest.canMakePayment())}createPaymentRequest(){return this.paymentRequest?this.paymentRequest:this.api.paymentRequest({country:this.settings.country,currency:C().settings().getCurrency().toLowerCase(),total:{label:h("Total","motopress-appointment"),amount:0,pending:!0},requestPayerName:!1,requestPayerEmail:!1,requestPayerPhone:!1,requestShipping:!1,disableWallets:this.getDisabledWallets()})}isCanMakePaymentRequest(){return this.canMakePaymentRequest}getPossibleWallets(){return["apple_pay","google_pay","link"]}isEnabledWallets(){let e=!1;return this.getPossibleWallets().forEach((t=>{this.settings.payment_methods.includes(t)&&(e=!0)})),e}getDisabledWallets(){let e=[];return this.getPossibleWallets().forEach((t=>{if(!this.settings.payment_methods.includes(t)){const s=t.toLowerCase().replace(/([-_][a-z])/g,(e=>e.toUpperCase().replace("-","").replace("_","")));e.push(s)}})),e}createPaymentRequestButton(){return this.elements.create("paymentRequestButton",{paymentRequest:this.paymentRequest,style:{paymentRequestButton:{height:"50px"}}})}processPaymentRequestButton(e){this.paymentRequestButtonEvent=e,jQuery(".mpa-booking-step-payment .mpa-actions .mpa-button-next").trigger("click")}proccessPaymentRequestButtonHandler(e,t){const s=e.getCustomer();return this.api.createPaymentMethod({type:"card",card:{token:this.paymentRequestButtonEvent.token.id},billing_details:{name:s.name,email:s.email,phone:s.phone}}).then((t=>{if(t.error)throw this.paymentRequestButtonEvent.complete("fail"),new Error(t.error.message);return f("/payments/prepare",{payment_details:jQuery.extend(e.paymentDetails,{payment_method_id:t.paymentMethod.id})})})).then((({client_secret:e})=>this.confirmPayment(e).then((e=>{if(e.error)throw this.paymentRequestButtonEvent.complete("fail"),this.paymentRequestButtonEvent=null,new Error(e.error.message);return e.paymentIntent})))).then((e=>{let t={payment_method:this.name,payment_intent_id:e.id};return this.paymentRequestButtonEvent.complete("success"),this.paymentRequestButtonEvent=null,t})).catch((e=>{throw this.paymentRequestButtonEvent.complete("fail"),this.paymentRequestButtonEvent=null,console.error("Unable to process payment.",e.message),null!=t.error_handler&&t.error_handler(e.message),e}))}confirmPayment(e){return this.api.confirmCardPayment(e)}processPayment(e,t,s){return this.paymentRequestButtonEvent?this.proccessPaymentRequestButtonHandler(e,s):super.processPayment(e,t,s)}createControl(){return this.elements.create(this.name,{style:this.settings.style,hidePostalCode:this.settings.hide_postal_code})}}class Ge extends Ue{setupProperties(){this.name="sepa_debit",this.title=h("SEPA Direct Debit","motopress-appointment")}confirmPayment(e,t){return this.api.confirmSepaDebitPayment(e)}createControl(){return this.elements.create("iban",{style:this.settings.style,supportedCountries:["SEPA"]})}}class Ye extends Ue{setupProperties(){this.name="bancontact",this.title=h("Bancontact","motopress-appointment")}confirmPayment(e,t){return this.api.confirmBancontactPayment(e,{return_url:t},{handleActions:!1})}}class Qe extends Ue{setupProperties(){this.name="ideal",this.title=h("iDEAL","motopress-appointment")}confirmPayment(e,t){return this.api.confirmIdealPayment(e,{return_url:t},{handleActions:!1})}createControl(){return this.elements.create("idealBank",{style:this.settings.style})}}class Ke extends Ue{setupProperties(){this.name="giropay",this.title=h("Giropay","motopress-appointment")}confirmPayment(e,t){return this.api.confirmGiropayPayment(e,{return_url:t},{handleActions:!1})}}class Ze extends Ue{setupProperties(){this.name="sofort",this.title=h("SOFORT","motopress-appointment")}confirmPayment(e,t){return this.api.confirmSofortPayment(e,{return_url:t},{handleActions:!1})}createPaymentMethodData(e,t,s){let i=super.createPaymentMethodData(e,t,s);return i.sofort={country:this.settings.country},i}}class Je extends qe{setupProperties(){super.setupProperties(),this.$gatewayPreloader=null,this.gatewayId="stripe",this.methods=null,this.view=null}constructor(e,t){super(e,t),this.$gatewayPreloader=e.parent().find(".mpa-payment-gateway-title .mpa-preloader")}isValidAcceptTerms(){if(!C().settings().getTermsPageIdForAcceptance())return!0;const e=this.$mountWrapper.closest("form").find(".mpa-accept-terms")[0];return!!e.checkValidity()||(e.reportValidity(),!1)}convertToSmallestUnit(e,t){switch(t||(t=C().settings().getCurrency()),t.toUpperCase()){case"BIF":case"CLP":case"DJF":case"GNF":case"JPY":case"KMF":case"KRW":case"MGA":case"PYG":case"RWF":case"UGX":case"VND":case"VUV":case"XAF":case"XOF":case"XPF":e=Math.floor(e);break;default:e=Math.round(100*e)}return e}getFormattedTotalPrice(){const e=this.cart.getOrder();let t=parseFloat(e.total);return this.cart.paymentDetails.deposit&&(t=parseFloat(e.deposit)),this.convertToSmallestUnit(t,C().settings().getCurrency().toLowerCase())}onClickPaymentRequestButton(e){this.isValidAcceptTerms()?this.methods.card.paymentRequest.update({total:{amount:this.getFormattedTotalPrice(),label:h("Total","motopress-appointment"),pending:!1}}):e.preventDefault()}onChange(e){this.haveErrors=!!e.error,this.haveErrors?this.view.showError(e.error.message):this.view.hideErrors()}onCartChange(e){this.isMounted&&0<this.getFormattedTotalPrice()&&0===Object.keys(this.methods).length&&(this.$mountWrapper.empty(),this.mount(this.$mountWrapper))}mount(e){this.ready().then((()=>{this.methods=[],0<this.getFormattedTotalPrice()&&(this.methods=this.createPaymentMethods()),this.view=new ze(this.methods),this.view.mount(e),this.addListeners()}))}processPayment(e,t){if(!this.isValid())return Promise.reject(new Error("The payment gateway is not valid."));this.$gatewayPreloader.removeClass("mpa-hide");let s=this.view.selectedMethod,i=jQuery.extend({payment_method:s},this.settings,t),n={error_handler:this.view.showError.bind(this.view)};return this.methods[s].processPayment(e,i,n).then((e=>(this.$gatewayPreloader.addClass("mpa-hide"),e)),(e=>{throw this.$gatewayPreloader.addClass("mpa-hide"),e}))}getDefaults(){return jQuery.extend(super.getDefaults(),{hide_postal_code:!0,locale:"auto",payment_methods:[],public_key:"",style:{}})}createPaymentMethods(){let e=[];const t=Stripe(this.settings.public_key,{apiVersion:"2023-10-16"}),s=t.elements({mode:"payment",locale:this.settings.locale,currency:C().settings().getCurrency().toLowerCase(),amount:this.getFormattedTotalPrice(),payment_method_configuration:this.settings.payment_method_configuration});return this.settings.payment_methods.forEach((i=>{switch(i){case"payment":e.payment=new je(t,s,this.settings),e.payment.provideCart(this.cart);break;case"card":e.card=new We(t,s,this.settings),e.card.getControl().on("change",this.onChange.bind(this)),e.card.isCanMakePaymentRequest().then((t=>{t&&(e.card.paymentRequest.on("token",(async t=>e.card.processPaymentRequestButton(t))),e.card.paymentRequest.on("cancel",(()=>{e.card.paymentRequestButtonEvent=null})),e.card.paymentRequestButton=e.card.createPaymentRequestButton(),e.card.paymentRequestButton.on("click",this.onClickPaymentRequestButton.bind(this)))}));break;case"sepa_debit":e.sepa_debit=new Ge(t,s,this.settings),e.sepa_debit.getControl().on("change",this.onChange.bind(this));break;case"bancontact":e.bancontact=new Ye(t,s,this.settings);break;case"ideal":e.ideal=new Qe(t,s,this.settings);break;case"giropay":e.giropay=new Ke(t,s,this.settings);break;case"sofort":e.sofort=new Ze(t,s,this.settings)}})),e}reset(){this.methods&&Object.entries(this.methods).forEach((([e,t])=>{t.reset()})),this.view&&this.view.reset()}}class Xe extends qe{setupProperties(){super.setupProperties(),this.gatewayId="paypal"}enable(){super.enable(),this.isEnabled&&this.$mountWrapper.closest("form").find(".mpa-button-next").hide()}disable(){super.disable(),this.isEnabled||this.$mountWrapper.closest("form").find(".mpa-button-next").show()}mount(e){let t=this;t.$errorWrapper=e.find(".mpa-paypal-error"),t.$gatewayPreloader=e.parent().find(".mpa-payment-gateway-title .mpa-preloader"),paypal.Buttons({onInit(e,s){if(C().settings().getTermsPageIdForAcceptance()){const e=t.$mountWrapper.closest("form").find(".mpa-accept-terms")[0];e.checkValidity()||s.disable(),e.addEventListener("change",(e=>{e.target.checked?s.enable():s.disable()}))}},onClick:function(e,s){if(C().settings().getTermsPageIdForAcceptance()){const e=t.$mountWrapper.closest("form").find(".mpa-accept-terms")[0];e.checkValidity()||e.reportValidity()}0===t.cart.getTotalPrice()&&(t.paypalDetails={},jQuery(".mpa-booking-step-payment .mpa-actions .mpa-button-next").trigger("click"))},createOrder:function(e,s){return t.$errorWrapper.addClass("mpa-hide"),t.$gatewayPreloader.removeClass("mpa-hide"),f("/payments/prepare",{payment_details:t.cart.paymentDetails}).then((e=>(t.$gatewayPreloader.addClass("mpa-hide"),e)))},onApprove:function(e,s){return s.order.capture().then((function(e){t.paypalDetails=e,jQuery(".mpa-booking-step-payment .mpa-actions .mpa-button-next").trigger("click")}))},onCancel:function(e){},onError:function(e){console.log(e),t.$errorWrapper.text(t.settings.paypal_error_message),t.$errorWrapper.removeClass("mpa-hide")}}).render(e.find(".mpa-paypal-container")[0])}processPayment(e,t){return Promise.resolve({paypalDetails:this.paypalDetails})}}class et{static createGateways(e,t){let s={};for(let i of C().settings().getActiveGateways()){let n=e.find(".mpa-"+i+"-payment-gateway .mpa-billing-fields"),a=0!==n.length?et.createGateway(i,n,t):null;null!==a&&(s[i]=a)}return s.free=new Ve({},t),s}static createGateway(e,t,s){switch(e){case"manual":case"test":case"cash":case"bank":return new He(t,s);case"paypal":return new Xe(t,s);case"stripe":return new Je(t,s);default:return wp.hooks.applyFilters("mpa_create_gateway",null,e,t,s)}}}class tt extends we{setupProperties(){super.setupProperties(),this.lastCartHash="",this.gatewayId="",this.gateways={},this.bookingDetails={},this.$form=this.$element.find(".mpa-checkout-form"),this.$order=this.$element.find(".mpa-order"),this.$billingSection=this.$element.find(".mpa-billing-details"),this.$paymentGateways=this.$billingSection.find(".mpa-payment-gateway"),this.$paymentGatewayButtons=this.$paymentGateways.find('input[name="payment_gateway_id"]'),this.$message=this.$element.find(".mpa-message").first(),this.acceptTerms=!1,this.onlinePayment=!1,this.isDepositDisabled=!1,this.$deposit=this.$element.find(".mpa-deposit-section"),this.$depositSwitcher=this.$element.find('input[name="mpa-deposit-switcher"]'),this.$depositTable=this.$element.find("#mpa-deposit-table"),C().settings().getTermsPageIdForAcceptance()&&(this.$acceptTerms=this.$element.find(".mpa-accept-terms")),this.couponSection=null}theId(){return"payment"}propertiesSchema(){return{gatewayId:{type:"string",default:""},isDepositDisabled:{type:"bool",default:!1},acceptTerms:{type:"bool",default:!1}}}setErrorMessage(e){this.$message.html(e),this.$message.toggleClass("mpa-hide",!e.trim().length)}clearErrorMessage(){this.setErrorMessage("")}hideDeposit(){this.$deposit.addClass("mpa-hide"),this.$depositSwitcher.prop("disabled",!0),this.isDepositDisabled=!0}showDeposit(){this.$deposit.removeClass("mpa-hide"),this.$depositSwitcher.prop("disabled",!1),this.setProperty("isDepositDisabled",this.$depositSwitcher.prop("checked"))}toggleDepositSection(){const e=this.cart.getOrder();parseFloat(e.total)-parseFloat(e.deposit)&&this.onlinePayment?this.showDeposit():this.hideDeposit()}setGatewayId(e,t){this.setProperty("gatewayId",e),this.onlinePayment=parseInt(t),this.toggleDepositSection(),this.cart.setPaymentDetails({gateway_id:this.gatewayId,deposit:!this.isDepositDisabled})}addListeners(){super.addListeners(),this.$form.on("submit",(e=>!1)),this.$paymentGatewayButtons.on("change",(e=>{this.setGatewayId(e.target.value,e.target.dataset.isOnlinePayment)})),C().settings().getTermsPageIdForAcceptance()&&this.$acceptTerms.on("input",(e=>this.setProperty("acceptTerms",e.target.checked))),this.$depositSwitcher.length>0&&this.$depositSwitcher.on("input",(e=>{this.$depositTable.toggleClass("mpa-hide",e.target.checked),this.setProperty("isDepositDisabled",e.target.checked),this.cart.setPaymentDetails({deposit:!this.isDepositDisabled})})),this.$element.on("mpa_booking_step_disable",this.disable.bind(this)),this.$element.on("mpa_booking_step_enable",this.enable.bind(this)),this.$element.on("mpa_booking_coupon_applied",(()=>{this.notifyCartChanged(),this.updateOrderDetails(),this.cart.setPaymentDetails({coupon_code:this.cart.hasCoupon()?this.cart.coupon.getCode():""})}))}loadEntities(){this.isLoaded||this.$element.removeClass("mpa-hide"),this.lastCartHash=this.cart.getHash("order"),C().settings().isCouponsEnabled()&&(this.couponSection=new Re(this.$element.find(".mpa-coupon-details"),this.cart)),this.updateOrderDetails();let e=[];return"free"!==this.gatewayId?e.push(this.loadGateways()):this.loadGateways(),e.push(this.loadDrafts()),Promise.all(e).then((()=>(this.initDefaultGateway(),this)))}reload(){return this.clearErrorMessage(),this.cart.hasCoupon()&&this.cart.testCoupon(),this.couponSection&&(this.cart.hasCoupon()?this.couponSection.clearMessage():this.couponSection.reset()),this.updateOrderDetails(),this.cart.didChange(this.lastCartHash,"order")?(this.lastCartHash=this.cart.getHash("order"),this.notifyCartChanged(),this.loadDrafts()):wp.hooks.applyFilters("mpa_booking_reload_drafts",!1)?this.loadDrafts():Promise.resolve(this)}reset(){C().settings().getTermsPageIdForAcceptance()&&(this.$acceptTerms.prop("checked",!1),this.resetProperty("acceptTerms")),this.lastCartHash="";let e=C().settings().getDefaultPaymentGateway();this.$paymentGatewayButtons.filter(":checked").prop("checked",!1),e in this.gateways?(this.setProperty("gatewayId",e),this.$paymentGatewayButtons.filter('[value="'+e+'"]').prop("checked",!0)):this.resetProperty("gatewayId");for(let e in this.gateways)this.gateways[e].reset();this.couponSection&&this.couponSection.reset()}notifyCartChanged(){for(let e in this.gateways)this.gateways[e].onCartChange(this.cart)}updateOrderDetails(){if(this.$order.empty(),this.$order.html(Ie(this.cart.getOrder())),this.$depositTable.length>0){const e=function(e){const t=parseFloat(e.total)-parseFloat(e.deposit);let s="";return t>0&&(s+='<table class="widefat">',s+="<tbody>",s+='<tr class="mpa-deposit-title">',s+='<td class="column-title" colspan="2">',s+=h("Deposit","motopress-appointment"),s+="</td>",s+="</tr>",s+='<tr class="mpa-deposit-now">',s+='<th class="column-title">',s+=h("Paying now","motopress-appointment"),s+="</th>",s+='<th class="column-price">',s+=De(e.deposit),s+="</th>",s+="</tr>",s+='<tr class="mpa-deposit-left">',s+='<th class="column-title">',s+=h("Left to pay","motopress-appointment"),s+="</th>",s+='<th class="column-price">',s+=De(t),s+="</th>",s+="</tr>",s+="</tbody>",s+="</table>"),s}(this.cart.getOrder());this.$depositTable.html(e),this.$paymentGatewayButtons.filter(":checked").length>0&&this.toggleDepositSection()}let e=this.$order.find(".mpa-remove-coupon");e.length>0&&e.on("click",this.removeCoupon.bind(this)),this.toggleAvailablePaymentMethods()}removeCoupon(e){e.preventDefault(),e.stopPropagation(),this.cart.removeCoupon(),this.couponSection.clearMessage(),this.cart.setPaymentDetails({coupon_code:""}),this.notifyCartChanged(),this.updateOrderDetails(),this.couponSection.reset()}toggleAvailablePaymentMethods(){const e=0===this.cart.getTotalPrice();if(e)this.setGatewayId("free",!1);else{const e=this.$paymentGatewayButtons.filter(":checked");e.length>0&&this.setGatewayId(e[0].value,e[0].dataset.isOnlinePayment)}this.$billingSection.toggleClass("mpa-hide",e),this.$paymentGatewayButtons.prop("required",!e)}loadGateways(){let e=this.$billingSection.find(".mpa-payment-gateways");this.gateways=et.createGateways(e,this.cart);let t=[];for(let e in this.gateways)t.push(this.gateways[e].load());return t}loadDrafts(){let e=this.cart.toArray();return e.payment=!0,f("/bookings/draft",wp.hooks.applyFilters("mpa_booking_draft_data",e)).then((e=>{this.bookingDetails=e;const t={booking_id:e.booking_id,payment_id:e.payment_id};this.cart.setPaymentDetails(t)}),(e=>{this.setErrorMessage(e.message)})).then((()=>(this.enableGateways(),this)))}enableGateways(){this.$paymentGatewayButtons.prop("disabled",!1)}initDefaultGateway(){let e=this.$paymentGatewayButtons.filter(":checked");e.length>0&&this.gateways[e.val()].enable()}isValidInput(){return this.isValidGatewayId()&&this.isValidGateway()&&this.isValidAcceptTerms()}isValidGatewayId(){return""!==this.gatewayId}isValidGateway(){return!(this.gatewayId in this.gateways)||this.gateways[this.gatewayId].isValid()}isValidAcceptTerms(){return!C().settings().getTermsPageIdForAcceptance()||this.acceptTerms}afterUpdate(e,t,s){s in this.gateways&&this.gateways[s].disable(),t in this.gateways&&this.gateways[t].enable()}react(){super.react(),this.$buttonNext.prop("disabled",!1)}maybeSubmit(){if(this.couponSection&&this.couponSection.disable(),this.gatewayId in this.gateways){let e=this.gateways[this.gatewayId].processPayment(this.cart,this.bookingDetails);return"object"==typeof e&&"function"==typeof e.then&&e.then((e=>(this.cart.setPaymentDetails(e),e)),(e=>{this.setErrorMessage(e.message)})),e}}cancelSubmission(){super.cancelSubmission(),this.couponSection&&this.couponSection.enable()}}class st extends we{setupProperties(){super.setupProperties(),this.cartItem=null,this.lastHash="",this.monthSlots={},this.date="",this.time="",this.datepicker=null,this.$dateWrapper=this.$element.find(".mpa-date-wrapper"),this.$dateInput=this.$element.find(".mpa-date"),this.$timeWrapper=this.$element.find(".mpa-time-wrapper"),this.$times=this.$timeWrapper.find(".mpa-times"),this.lookedAheadMonths=0,this.maxLookAheadMonths=12,this.isSelectedFirstAvailableSlot=!1,this.availabilityService=null}setAvailabilityService(e){this.availabilityService=e}theId(){return"period"}getCartContext(){return"cart item"}propertiesSchema(){return{date:{type:"string",default:""},time:{type:"string",default:""}}}addListeners(){super.addListeners(),this.$dateInput.on("change",(e=>this.setProperty("date",e.target.value)))}loadEntities(){return this.cartItem=this.cart.getActiveItem(),this.lastHash=this.cartItem.getHash("availability"),Promise.resolve(this)}reload(){return this.cartItem.didChange(this.lastHash,"availability")?(this.$element.removeClass("mpa-loaded"),this.resetDate(),this.readyPromise=this.loadEntities(),this.monthSlots={},null!=this.datepicker&&(this.setEnabledDays([]),this.readyPromise.finally((()=>this.resetEnabledDays()))),this.readyPromise):Promise.resolve(this)}reset(){this.cartItem=this.cart.getActiveItem(),this.lastHash="",this.monthSlots={},this.resetDate()}isValidInput(){return""!=this.date&&""!=this.time}resetDate(){this.resetProperty("date")}resetTime(){this.$times.empty(),this.resetProperty("time")}setEnabledDays(e){W(e,!0)?this.datepicker.set("enable",["2000-01-01"]):this.datepicker.set("enable",e)}afterUpdate(e,t,s){"date"==e&&(""==t?this.resetTime():this.resetTimeSlots())}react(){super.react(),this.$timeWrapper.toggleClass("mpa-hide",""==this.date)}showReady(){super.showReady(),null==this.datepicker&&(this.showDatepicker(),this.resetEnabledDays())}showDatepicker(){this.datepicker=function(e,t){let s=t.locale||C().settings().getFlatpickrLocale(),i=flatpickr.l10ns[s]||s;"object"==typeof i&&(i.firstDayOfWeek=C().settings().getFirstDayOfWeek());let n={formatDate:E,inline:!0,locale:i,monthSelectorType:"static",showMonths:1};t=jQuery.extend({},n,t);let a=null;return a=e instanceof jQuery?flatpickr(e[0],t):flatpickr(e,t),a}(this.$dateInput,this.getDatepickerArgs())}getDatepickerArgs(){return{minDate:C().settings().getBusinessDate(),onMonthChange:()=>this.resetEnabledDays()}}maybeSubmit(){let e=this.cartItem;if(e.date=k(this.date),e.time=new B(this.time),e.date&&e.time&&e.time.setDate(e.date),null===e.employee||null===e.location){let t=this.autoselectIds(),s=t[0],i=t[1];null===e.employee&&e.setEmployee(s,!1),null===e.location&&e.setLocation(i,!1)}let t=this.getCurrentMonthKey();this.cartItem.setBookingVariants(this.monthSlots[t][this.date][this.time]),document.dispatchEvent(new CustomEvent("mpa_add_to_cart",{detail:{cartItem:e,currencyCode:C().settings().getCurrency()}})),document.dispatchEvent(new CustomEvent("mpa_view_cart",{detail:{cart:this.cart,currencyCode:C().settings().getCurrency()}}))}selectFirstDateTimeSlot(){let e=this.datepicker.currentYear,t=this.datepicker.currentMonth,s=this.getMonthKey(e,t);const i=this.monthSlots[s];if(i&&Object.keys(i).length>0){const e=Object.keys(i)[0],t=Object.keys(i[e])[0];this.datepicker.setDate(e,!0);this.$times.children(".mpa-time-period").filter(((e,s)=>s.getAttribute("date-time")===t)).trigger("click"),this.isSelectedFirstAvailableSlot=!0}else{if(!0===this.isSelectedFirstAvailableSlot)return;if(this.lookedAheadMonths>=this.maxLookAheadMonths)return this.datepicker.changeMonth(-this.lookedAheadMonths),void(this.isSelectedFirstAvailableSlot=!0);this.lookedAheadMonths+=1,this.datepicker.changeMonth(1),this.reload()}}autoselectIds(){let e=[0,0],t=this.getCurrentMonthKey();if(this.monthSlots[t]&&this.monthSlots[t][this.date]){let s=this.monthSlots[t][this.date];for(let t in s)if(t===this.time){let i=s[t];e[0]=i[0][0],e[1]=i[0][1];break}}return e}waitForServiceToLoad(){let e=this.availabilityService.getServicePromise();return null!==e?e:Promise.resolve(this.cartItem.getService())}resetEnabledDays(){this.resetDate(),this.setEnabledDays([]),this.$dateWrapper.removeClass("mpa-loaded");let e=this.datepicker.currentYear,t=this.datepicker.currentMonth,s=this.getMonthKey(e,t),i=null;if(this.monthSlots[s])i=Promise.resolve(this.monthSlots[s]);else{i=function(e,t,s,i){return _("/calendar/time",{service_id:e,employee_in:i.employee_in?i.employee_in.join(","):"",location_in:i.location_in?i.location_in.join(","):"",date_from:E(t,"internal"),date_to:E(s,"internal"),exclude_cart:i.exclude_cart?i.exclude_cart:[]}).catch((e=>console.error("Failed to make time slots in mpa_time_slots().",e.message)||{}))}(this.cartItem.service.id,new Date(e,t,1),new Date(e,t+1,1),this.getTimeSlotsQueryArgs())}Promise.all([i,this.waitForServiceToLoad()]).then((e=>{let t=e[0];this.monthSlots[s]=t,this.setEnabledDays(Object.keys(t)),this.$dateWrapper.addClass("mpa-loaded"),this.selectFirstDateTimeSlot()}))}getTimeSlotsQueryArgs(){let e=this.cartItem.getEmployeeId(),t=this.cartItem.getLocationId();return{employee_in:e?[e]:this.cartItem.getAvailableEmployeeIds(),location_in:t?[t]:this.cartItem.getAvailableLocationIds(),exclude_cart:this.cart.toArray("items")}}resetTimeSlots(){this.resetTime();let e={},t=this.getCurrentMonthKey();null!=this.monthSlots[t][this.date]&&(e=this.monthSlots[t][this.date]);let s=0;for(let t in e){let i=new B(t).toString("public",'<span class="mpa-period-end-time"> - ')+"</span>",n=this.cartItem.getService();if(n.isGroupService()){let s=n.getMinCapacity();for(let i of e[t])s=Math.max(s,i[3]);i+=" ",i+='<span class="mpa-slot-capacity">',i+='<span class="mpa-slot-capacity-label">'+n.getQuantityLabel()+":</span>",i+="&nbsp;",i+='<span class="mpa-slot-capacity-number">'+s+"</span>",i+="</span>"}let a=Pe(i,{class:"button button-secondary mpa-time-period","date-time":t});this.$times.append(a),s++}s>0?this.$times.children(".mpa-time-period").on("click",(e=>this.onTime(e,e.currentTarget))):this.$times.text(h("Sorry, but we were unable to allocate time slots for the date you selected.","motopress-appointment"))}getMonthKey(e,t){return t<=8?e+"-0"+(t+1):e+"-"+(t+1)}getCurrentMonthKey(){if(""!==this.date){let e=k(this.date);return this.getMonthKey(e.getFullYear(),e.getMonth())}return"2000-01"}onTime(e,t){this.$times.children(".mpa-time-period-selected").removeClass("mpa-time-period-selected"),t.classList.add("mpa-time-period-selected"),this.setProperty("time",t.getAttribute("date-time"))}}class it extends we{setupProperties(){super.setupProperties(),this.availabilityService=null,this.category="",this.serviceId=0,this.employeeId=0,this.locationId=0,this.isHiddenStep=!0,this.$form=this.$element.find(".mpa-service-form"),this.$categories=this.$element.find(".mpa-service-category-wrapper"),this.$services=this.$element.find(".mpa-service-wrapper"),this.$employees=this.$element.find(".mpa-employee-wrapper"),this.$locations=this.$element.find(".mpa-location-wrapper"),this.$selects=this.$element.find(".mpa-input-wrapper select"),this.$categoriesSelect=this.$selects.filter(".mpa-service-category"),this.$servicesSelect=this.$selects.filter(".mpa-service"),this.$employeesSelect=this.$selects.filter(".mpa-employee"),this.$locationsSelect=this.$selects.filter(".mpa-location"),this.unselectedServiceText=this.$servicesSelect.children('[value=""]').text(),this.unselectedOptionText=this.$selects.filter(".mpa-optional-select").first().find("option:first").text()}setAvailabilityService(e){this.availabilityService=e}theId(){return"service-form"}getCartContext(){return"cart item"}propertiesSchema(){return{category:{type:"string",default:""},serviceId:{type:"integer",default:0},employeeId:{type:"integer",default:0},locationId:{type:"integer",default:0}}}addListeners(){super.addListeners(),this.$form.on("submit",this.submitForm.bind(this)),this.$categoriesSelect.on("change",(e=>this.setProperty("category",e.target.value))),this.$servicesSelect.on("change",(e=>this.setProperty("serviceId",e.target.value))),this.$employeesSelect.on("change",(e=>this.setProperty("employeeId",e.target.value))),this.$locationsSelect.on("change",(e=>this.setProperty("locationId",e.target.value)))}isHiddenElementByProp(e){const t=e.attr("data-is-hidden");return void 0!==t&&"false"!==t}initCategoriesSelect(){if(0==this.$categoriesSelect.length)return;this.updateCategorySchema();let e=this.$categoriesSelect.val(),t=this.isHiddenElementByProp(this.$categoriesSelect);if(this.$categoriesSelect.attr("data-default")){const s=this.$categoriesSelect.attr("data-default");this.isValidCategoryBySchema(s)?e=s:t=!1}this.setProperty("category",e),this.renderCategorySelect(),t||(this.isHiddenStep=!1),this.$categories.toggleClass("mpa-hide",t)}initServicesSelect(){if(0==this.$servicesSelect.length)return;this.updateServiceSchema();let e=this.$servicesSelect.val(),t=this.isHiddenElementByProp(this.$servicesSelect);if(this.$servicesSelect.attr("data-default")){const s=$(this.$servicesSelect.attr("data-default"));this.isValidServiceBySchema(s)?e=s:t=!1}this.setProperty("serviceId",e),this.renderServiceSelect(),t||(this.isHiddenStep=!1),this.$services.toggleClass("mpa-hide",t)}initEmployeesSelect(){if(0==this.$employeesSelect.length)return;this.updateEmployeeSchema();let e=this.$employeesSelect.val(),t=this.isHiddenElementByProp(this.$employeesSelect);if(this.$employeesSelect.attr("data-default")){const s=$(this.$employeesSelect.attr("data-default"));this.isValidEmployeeBySchema(s)?e=s:t=!1}this.setProperty("employeeId",e),this.renderEmployeeSelect(),t||(this.isHiddenStep=!1),this.$employees.toggleClass("mpa-hide",t)}initLocationsSelect(){if(0==this.$locationsSelect.length)return;this.updateLocationSchema();let e=this.$locationsSelect.val(),t=this.isHiddenElementByProp(this.$locationsSelect);if(this.$locationsSelect.attr("data-default")){const s=$(this.$locationsSelect.attr("data-default"));this.isValidLocationBySchema(s)?e=s:t=!1}this.setProperty("locationId",e),this.renderLocationSelect(),t||(this.isHiddenStep=!1),this.$locations.toggleClass("mpa-hide",t)}loadEntities(){return this.availabilityService.ready().finally((()=>(this.initServicesSelect(),this.initCategoriesSelect(),this.initEmployeesSelect(),this.initLocationsSelect(),this)))}reset(){let e={category:this.$categoriesSelect,serviceId:this.$servicesSelect,employeeId:this.$employeesSelect,locationId:this.$locationsSelect};this.preventReact=!0;for(let t in e){let s=e[t].attr("data-default");s?this.setProperty(t,s):this.resetProperty(t)}this.preventReact=!1,this.isActive&&this.react()}isValidInput(){return 0!=this.serviceId}updateCategorySchema(){const e=this.availabilityService.getAvailableServiceCategories();this.schema.category.options=Object.keys(e)}updateServiceSchema(){const e=this.availabilityService.getAvailableServices(this.category,this.locationId,this.employeeId);this.schema.serviceId.options=Object.keys(e).map($)}updateEmployeeSchema(){const e=this.availabilityService.getAvailableEmployees(this.serviceId,this.locationId);this.schema.employeeId.options=Object.keys(e).map($)}updateLocationSchema(){const e=this.availabilityService.getAvailableLocations(this.serviceId,this.employeeId);this.schema.locationId.options=Object.keys(e).map($)}isValidCategoryBySchema(e){return this.schema.category.options.includes(e)}isValidServiceBySchema(e){return this.schema.serviceId.options.includes(e)}isValidLocationBySchema(e){return this.schema.locationId.options.includes(e)}isValidEmployeeBySchema(e){return this.schema.employeeId.options.includes(e)}afterUpdate(e,t,s){if(this.updateCategorySchema(),this.updateServiceSchema(),this.updateEmployeeSchema(),this.updateLocationSchema(),"category"===e){let e=this.availabilityService.getAvailableServices(this.category,this.locationId,this.employeeId);this.serviceId in e||(this.resetProperty("serviceId"),this.resetProperty("employeeId"),this.resetProperty("locationId"))}}react(){super.react(),this.$categoriesSelect.val(this.category||""),this.$servicesSelect.val(this.serviceId||""),this.$employeesSelect.val(this.employeeId),this.$locationsSelect.val(this.locationId),this.$categoriesSelect.toggleClass("mpa-selected",""!=this.category),this.$servicesSelect.toggleClass("mpa-selected",0!=this.serviceId),this.$employeesSelect.toggleClass("mpa-selected",0!=this.employeeId),this.$locationsSelect.toggleClass("mpa-selected",0!=this.locationId),this.renderCategorySelect(),this.renderServiceSelect(),this.renderEmployeeSelect(),this.renderLocationSelect(),this.$buttonNext.prop("disabled",!1)}renderCategorySelect(){this.preventUpdate=!0,Be(this.$categoriesSelect,{"":this.unselectedOptionText},this.availabilityService.getAvailableServiceCategories(),this.category||""),this.preventUpdate=!1}renderServiceSelect(){this.preventUpdate=!0;let e=this.availabilityService.getAvailableServices(this.category,this.locationId,this.employeeId);Be(this.$servicesSelect,{"":this.unselectedServiceText},e,this.serviceId in e?this.serviceId:""),this.preventUpdate=!1}renderEmployeeSelect(){this.preventUpdate=!0,Be(this.$employeesSelect,{0:this.unselectedOptionText},this.availabilityService.getAvailableEmployees(this.serviceId,this.locationId),this.employeeId),this.preventUpdate=!1}renderLocationSelect(){this.preventUpdate=!0,Be(this.$locationsSelect,{0:this.unselectedOptionText},this.availabilityService.getAvailableLocations(this.serviceId,this.employeeId),this.locationId),this.preventUpdate=!1}show(){this.$servicesSelect.prop("required",!0),super.show()}hide(){super.hide(),this.$servicesSelect.prop("required",!1)}enable(){super.enable(),this.$selects.prop("disabled",!1)}disable(){super.disable(),this.$selects.prop("disabled",!0)}submitForm(e){this.isActive&&!this.isValidInput()||e.preventDefault()}maybeSubmit(){let e=this.cart.getActiveItem();if(null===e)return console.error("Unable to get active cart item in StepServiceForm.maybeSubmit().");if(e.setService(this.availabilityService.getService(this.serviceId,!0,(()=>{document.dispatchEvent(new CustomEvent("mpa_view_item",{detail:{cartItem:e,currencyCode:C().settings().getCurrency()}}))}))),e.setServiceCategories(this.availabilityService.getServiceCategories(this.serviceId)),0!==this.employeeId?e.setEmployee(this.availabilityService.getEmployee(this.employeeId)):e.setAvailableEmployees(this.availabilityService.filterAvailableEmployees(this.serviceId,this.locationId,"entities")),0!==this.locationId)e.setLocation(this.availabilityService.getLocation(this.locationId));else{let t=this.employeeId||e.getAvailableEmployeeIds();e.setAvailableLocations(this.availabilityService.filterAvailableLocations(this.serviceId,t,"entities"))}}}class nt{constructor(e){this.$element=e,this.$message=this.$element.children(".mpa-message"),this.cart=new fe,this.steps=new ve(this.cart),this.load()}setupSteps(){this.steps.addStep(new it(this.$element.find(".mpa-booking-step-service-form"),this.cart)).addStep(new st(this.$element.find(".mpa-booking-step-period"),this.cart)).addStep(new Fe(this.$element.find(".mpa-booking-step-cart"),this.cart)).addStep(new Ne(this.$element.find(".mpa-booking-step-checkout"),this.cart)),C().settings().isPaymentsEnabled()&&this.steps.addStep(new tt(this.$element.find(".mpa-booking-step-payment"),this.cart)),this.steps.addStep(new Ee(this.$element.find(".mpa-booking-step-booking"),this.cart)),this.steps.mount(this.$element)}load(){this.cart.createItem();let e=new Y;Promise.all([e.load(),C().settings().ready()]).finally((()=>{this.setupSteps(),this.steps.getStep("service-form").setAvailabilityService(e),this.steps.getStep("period").setAvailabilityService(e),this.show(),e.isEmpty()?(this.$message.html(h("Sorry, there are no services, employees or locations to book.","motopress-appointment")),this.$message.removeClass("mpa-hide")):this.steps.goToNextStep()}))}show(){this.$element.addClass("mpa-loaded")}}function at(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(let n of s)if(!i.includes(n)||!at(e[n],t[n]))return!1;return!0}const{serverSideRender:ot}=wp,{Component:rt,Fragment:lt}=wp.element,{Disabled:pt,Placeholder:mt,Spinner:ct}=wp.components,{jQuery:ht}=window;const{registerBlockType:dt}=wp.blocks;dt("motopress-appointment/appointment-form",{title:s.__("Appointment Form","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("path",{d:"M0,18v6h24v-6H0z M22,22H2v-2h20V22z"}),wp.element.createElement("path",{d:"M21,7V1h-3V0h-2v1H8V0H6v1H3v6v9h18V7z M5,3h1v1h2V3h8v1h2V3h1v2H5V3z M5,14V7h14v7H5z"}),wp.element.createElement("rect",{x:"7",y:"8",width:"2",height:"2"}),wp.element.createElement("rect",{x:"11",y:"8",width:"2",height:"2"}),wp.element.createElement("rect",{x:"15",y:"8",width:"2",height:"2"}),wp.element.createElement("rect",{x:"7",y:"11",width:"2",height:"2"}),wp.element.createElement("rect",{x:"11",y:"11",width:"2",height:"2"}),wp.element.createElement("rect",{x:"15",y:"11",width:"2",height:"2"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{form_title:{type:"string",default:""},show_category:{type:"boolean",default:!0},show_service:{type:"boolean",default:!0},show_location:{type:"boolean",default:!0},show_employee:{type:"boolean",default:!0},label_category:{type:"string",default:""},label_service:{type:"string",default:""},label_location:{type:"string",default:""},label_employee:{type:"string",default:""},label_unselected:{type:"string",default:""},label_option:{type:"string",default:""},default_category:{type:"string",default:""},default_service:{type:"string",default:""},default_location:{type:"string",default:""},default_employee:{type:"string",default:""},timepicker_columns:{type:"number",default:3},show_timepicker_end_time:{type:"boolean",default:!1},show_add_to_calendar:{type:"boolean",default:!0},form_width:{type:"string",default:""},primary_color:{type:"string",default:""},primary_bg_color:{type:"string",default:""},secondary_color:{type:"string",default:""},secondary_bg_color:{type:"string",default:""},buttons_padding:{type:"string",default:""}},edit:class extends rt{state={initialized:!1};containerRef=React.createRef();observer=null;render(){return wp.element.createElement(lt,null,wp.element.createElement(ae,this.props),wp.element.createElement("div",{ref:this.containerRef},wp.element.createElement(pt,null,wp.element.createElement(ot,{block:"motopress-appointment/appointment-form",attributes:this.props.attributes,LoadingResponsePlaceholder:this.handleServerSideRenderLoad}))))}initAppointmentForm=()=>{const e=ht(this.containerRef.current).find(".appointment-form-shortcode").last();e.length&&!e.data("initialized")&&(new nt(e),e.data("initialized",!0))};handleAttributesUpdate=()=>{this.setState({initialized:!1},this.initAppointmentForm)};componentDidMount(){this.initAppointmentForm(),this.observeDOMChanges()}componentDidUpdate(e){at(this.props.attributes,e.attributes)||this.handleAttributesUpdate()}componentWillUnmount(){this.observer&&this.observer.disconnect()}observeDOMChanges(){const e=this.containerRef.current;this.observer=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&this.initAppointmentForm()}))})),this.observer.observe(e,{childList:!0,subtree:!0})}handleServerSideRenderLoad=({className:e})=>(setTimeout(this.handleAttributesUpdate,500),wp.element.createElement(mt,{className:e},wp.element.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},wp.element.createElement(ct,null))))},save:()=>null});const{Component:ut,Fragment:gt}=wp.element,{SelectControl:yt,PanelBody:bt,TextControl:_t,ToggleControl:ft,RangeControl:vt}=wp.components,{InspectorControls:wt}=wp.blockEditor||wp.editor;let Ct=class extends ut{render(){const{show_image:e,show_title:t,show_excerpt:i,show_contacts:n,show_social_networks:a,show_additional_info:o,employees:r,locations:l,posts_per_page:p,columns_count:m,orderby:c,order:h}=this.props.attributes,{setAttributes:d}=this.props;return[wp.element.createElement(wt,{key:"inspector"},wp.element.createElement(gt,null,wp.element.createElement(bt,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(ft,{label:s.__("Show featured image.","motopress-appointment"),checked:e,onChange:e=>{d({show_image:e})}}),wp.element.createElement(ft,{label:s.__("Show post title.","motopress-appointment"),checked:t,onChange:e=>{d({show_title:e})}}),wp.element.createElement(ft,{label:s.__("Show post excerpt.","motopress-appointment"),checked:i,onChange:e=>{d({show_excerpt:e})}}),wp.element.createElement(ft,{label:s.__("Show contact information.","motopress-appointment"),checked:n,onChange:e=>{d({show_contacts:e})}}),wp.element.createElement(ft,{label:s.__("Show social networks.","motopress-appointment"),checked:a,onChange:e=>{d({show_social_networks:e})}}),wp.element.createElement(ft,{label:s.__("Show additional information.","motopress-appointment"),checked:o,onChange:e=>{d({show_additional_info:e})}}),wp.element.createElement(_t,{label:s.__("Employees","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of employees that will be shown.","motopress-appointment"),value:r,onChange:e=>{d({employees:e})}}),wp.element.createElement(_t,{label:s.__("Locations","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of locations.","motopress-appointment"),value:l,onChange:e=>{d({locations:e})}}),wp.element.createElement(vt,{label:s.__("Posts Per Page","motopress-appointment"),value:p,onChange:e=>d({posts_per_page:e}),min:-1,max:100,placeholder:"0"}),wp.element.createElement(vt,{label:s.__("Columns Count","motopress-appointment"),help:s.__("The number of columns in the grid.","motopress-appointment"),value:m,onChange:e=>d({columns_count:e}),min:0,max:100,placeholder:"0"}),wp.element.createElement(yt,{label:s.__("Order By","motopress-appointment"),value:void 0!==c?c:"none",onChange:e=>d({orderby:e}),options:[{value:"none",label:s.__("No order","motopress-appointment")},{value:"ID",label:s.__("Post ID","motopress-appointment")},{value:"author",label:s.__("Post author","motopress-appointment")},{value:"title",label:s.__("Post title","motopress-appointment")},{value:"name",label:s.__("Post name (post slug)","motopress-appointment")},{value:"date",label:s.__("Post date","motopress-appointment")},{value:"modified",label:s.__("Last modified date","motopress-appointment")},{value:"rand",label:s.__("Random order","motopress-appointment")},{value:"relevance",label:s.__("Relevance","motopress-appointment")},{value:"menu_order",label:s.__("Page order","motopress-appointment")},{value:"menu_order title",label:s.__("Page order and post title","motopress-appointment")}]}),"none"!==c&&wp.element.createElement(yt,{label:s.__("Order","motopress-appointment"),value:void 0!==h?h:"desc",onChange:e=>d({order:e}),options:[{value:"desc",label:s.__("DESC","motopress-appointment")},{value:"asc",label:s.__("ASC","motopress-appointment")}]}))))]}};const{serverSideRender:St}=wp,{Component:Et,Fragment:kt}=wp.element,{Disabled:Pt}=wp.components;const{registerBlockType:Tt}=wp.blocks;Tt("motopress-appointment/employees-list",{title:s.__("Employees List","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{show_image:{type:"boolean",default:!0},show_title:{type:"boolean",default:!0},show_excerpt:{type:"boolean",default:!0},show_contacts:{type:"boolean",default:!0},show_social_networks:{type:"boolean",default:!0},show_additional_info:{type:"boolean",default:!0},employees:{type:"string",default:""},locations:{type:"string",default:""},posts_per_page:{type:"number",default:3},columns_count:{type:"number",default:3},orderby:{type:"string",default:"none"},order:{type:"string",default:"desc"}},edit:class extends Et{constructor(e){super(...arguments)}render(){return wp.element.createElement(kt,null,wp.element.createElement(Ct,this.props),wp.element.createElement(Pt,null,wp.element.createElement(St,{block:"motopress-appointment/employees-list",attributes:this.props.attributes})))}},save:()=>null});const{Component:It,Fragment:$t}=wp.element,{SelectControl:Dt,PanelBody:xt,TextControl:Mt,ToggleControl:At,RangeControl:Bt}=wp.components,{InspectorControls:Lt}=wp.blockEditor||wp.editor;let Ft=class extends It{render(){const{show_image:e,show_title:t,show_excerpt:i,locations:n,categories:a,posts_per_page:o,columns_count:r,orderby:l,order:p}=this.props.attributes,{setAttributes:m}=this.props;return[wp.element.createElement(Lt,{key:"inspector"},wp.element.createElement($t,null,wp.element.createElement(xt,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(At,{label:s.__("Show featured image.","motopress-appointment"),checked:e,onChange:e=>{m({show_image:e})}}),wp.element.createElement(At,{label:s.__("Show post title.","motopress-appointment"),checked:t,onChange:e=>{m({show_title:e})}}),wp.element.createElement(At,{label:s.__("Show post excerpt.","motopress-appointment"),checked:i,onChange:e=>{m({show_excerpt:e})}}),wp.element.createElement(Mt,{label:s.__("Locations","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of locations.","motopress-appointment"),value:n,onChange:e=>{m({locations:e})}}),wp.element.createElement(Mt,{label:s.__("Categories","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of categories that will be shown.","motopress-appointment"),value:a,onChange:e=>{m({categories:e})}}),wp.element.createElement(Bt,{label:s.__("Posts Per Page","motopress-appointment"),value:o,onChange:e=>m({posts_per_page:e}),min:-1,max:100,placeholder:"0"}),wp.element.createElement(Bt,{label:s.__("Columns Count","motopress-appointment"),help:s.__("The number of columns in the grid.","motopress-appointment"),value:r,onChange:e=>m({columns_count:e}),min:0,max:100,placeholder:"0"}),wp.element.createElement(Dt,{label:s.__("Order By","motopress-appointment"),value:void 0!==l?l:"none",onChange:e=>m({orderby:e}),options:[{value:"none",label:s.__("No order","motopress-appointment")},{value:"ID",label:s.__("Post ID","motopress-appointment")},{value:"author",label:s.__("Post author","motopress-appointment")},{value:"title",label:s.__("Post title","motopress-appointment")},{value:"name",label:s.__("Post name (post slug)","motopress-appointment")},{value:"date",label:s.__("Post date","motopress-appointment")},{value:"modified",label:s.__("Last modified date","motopress-appointment")},{value:"rand",label:s.__("Random order","motopress-appointment")},{value:"relevance",label:s.__("Relevance","motopress-appointment")},{value:"menu_order",label:s.__("Page order","motopress-appointment")},{value:"menu_order title",label:s.__("Page order and post title","motopress-appointment")}]}),"none"!==l&&wp.element.createElement(Dt,{label:s.__("Order","motopress-appointment"),value:void 0!==p?p:"desc",onChange:e=>m({order:e}),options:[{value:"desc",label:s.__("DESC","motopress-appointment")},{value:"asc",label:s.__("ASC","motopress-appointment")}]}))))]}};const{serverSideRender:Rt}=wp,{Component:Ot,Fragment:Nt}=wp.element,{Disabled:Ht}=wp.components;const{registerBlockType:Vt}=wp.blocks;Vt("motopress-appointment/locations-list",{title:s.__("Locations List","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M12,1C9.79,1,8,2.79,8,5s4,8,4,8s4-5.79,4-8S14.21,1,12,1z M12,7c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2S13.1,7,12,7z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{show_image:{type:"boolean",default:!0},show_title:{type:"boolean",default:!0},show_excerpt:{type:"boolean",default:!0},locations:{type:"string",default:""},categories:{type:"string",default:""},posts_per_page:{type:"number",default:3},columns_count:{type:"number",default:3},orderby:{type:"string",default:"none"},order:{type:"string",default:"desc"}},edit:class extends Ot{constructor(){super(...arguments)}render(){return wp.element.createElement(Nt,null,wp.element.createElement(Ft,this.props),wp.element.createElement(Ht,null,wp.element.createElement(Rt,{block:"motopress-appointment/locations-list",attributes:this.props.attributes})))}},save:()=>null});const{Component:zt,Fragment:qt}=wp.element,{SelectControl:Ut,PanelBody:jt,TextControl:Wt,ToggleControl:Gt,RangeControl:Yt}=wp.components,{InspectorControls:Qt}=wp.blockEditor||wp.editor;let Kt=class extends zt{render(){const{show_image:e,show_count:t,show_description:i,parent:n,categories:a,exclude_categories:o,hide_empty:r,depth:l,number:p,columns_count:m,orderby:c,order:h}=this.props.attributes,{setAttributes:d}=this.props;return[wp.element.createElement(Qt,{key:"inspector"},wp.element.createElement(qt,null,wp.element.createElement(jt,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(Gt,{label:s.__("Show featured image.","motopress-appointment"),checked:e,onChange:e=>{d({show_image:e})}}),wp.element.createElement(Gt,{label:s.__("Show Services Count?","motopress-appointment"),checked:t,onChange:e=>{d({show_count:e})}}),wp.element.createElement(Gt,{label:s.__("Show Description?","motopress-appointment"),checked:i,onChange:e=>{d({show_description:e})}}),wp.element.createElement(Wt,{label:s.__("Parent","motopress-appointment"),help:s.__("Parent term slug or ID to retrieve direct-child terms from.","motopress-appointment"),value:n,onChange:e=>{d({parent:e})}}),wp.element.createElement(Wt,{label:s.__("Categories","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of categories that will be shown.","motopress-appointment"),value:a,onChange:e=>{d({categories:e})}}),wp.element.createElement(Wt,{label:s.__("Exclude Categories","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of categories that will not be shown.","motopress-appointment"),value:o,onChange:e=>{d({exclude_categories:e})}}),wp.element.createElement(Gt,{label:s.__("Hide Empty","motopress-appointment"),help:s.__("Hide terms not assigned to any posts.","motopress-appointment"),checked:r,onChange:e=>{d({hide_empty:e})}}),wp.element.createElement(Yt,{label:s.__("Depth","motopress-appointment"),help:s.__("Display depth of child categories.","motopress-appointment"),value:l,onChange:e=>d({depth:e}),min:-1,max:100,placeholder:"0"}),wp.element.createElement(Yt,{label:s.__("Number","motopress-appointment"),help:s.__("Maximum number of categories to show.","motopress-appointment"),value:p,onChange:e=>d({number:e}),min:-1,max:100,placeholder:"0"}),wp.element.createElement(Yt,{label:s.__("Columns Count","motopress-appointment"),help:s.__("The number of columns in the grid.","motopress-appointment"),value:m,onChange:e=>d({columns_count:e}),min:0,max:100,placeholder:"0"}),wp.element.createElement(Ut,{label:s.__("Order By","motopress-appointment"),value:void 0!==c?c:"none",onChange:e=>d({orderby:e}),options:[{value:"none",label:s.__("No order","motopress-appointment")},{value:"name",label:s.__("Term name","motopress-appointment")},{value:"slug",label:s.__("Term slug","motopress-appointment")},{value:"term_id",label:s.__("Term ID","motopress-appointment")},{value:"parent",label:s.__("Parent ID","motopress-appointment")},{value:"count",label:s.__("Number of associated objects","motopress-appointment")},{value:"include",label:s.__('Keep the order of "IDs" parameter',"motopress-appointment")},{value:"term_order",label:s.__("Term order","motopress-appointment")}]}),"none"!==c&&wp.element.createElement(Ut,{label:s.__("Order","motopress-appointment"),value:void 0!==h?h:"desc",onChange:e=>d({order:e}),options:[{value:"desc",label:s.__("DESC","motopress-appointment")},{value:"asc",label:s.__("ASC","motopress-appointment")}]}))))]}};const{serverSideRender:Zt}=wp,{Component:Jt,Fragment:Xt}=wp.element,{Disabled:es}=wp.components;const{registerBlockType:ts}=wp.blocks;ts("motopress-appointment/service-categories",{title:s.__("Service Categories","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("path",{d:"M7.17,2l1.41,1.41L9.17,4H10h12v18H2V2H7.17 M8,0H0v2v22h24V2H10L8,0L8,0z"}),wp.element.createElement("path",{d:"M17.59,14.18l-1.02-0.8c0.01-0.11,0.02-0.24,0.02-0.38s-0.01-0.27-0.02-0.38l1.02-0.8c0.26-0.21,0.32-0.57,0.16-0.85\r l-1.12-1.92c-0.16-0.29-0.51-0.41-0.82-0.3l-1.2,0.48c-0.21-0.15-0.43-0.27-0.65-0.38l-0.18-1.28C13.73,7.24,13.45,7,13.12,7h-2.25\r c-0.33,0-0.61,0.24-0.65,0.56l-0.18,1.28C9.81,8.95,9.59,9.08,9.38,9.22l-1.2-0.48c-0.31-0.12-0.65,0-0.81,0.29l-1.13,1.94\r c-0.16,0.28-0.09,0.65,0.16,0.85l1.02,0.8C7.41,12.76,7.41,12.88,7.41,13s0,0.24,0.02,0.38l-1.03,0.8\r c-0.25,0.21-0.32,0.57-0.16,0.85l1.12,1.92c0.16,0.29,0.51,0.41,0.82,0.29l1.2-0.48c0.21,0.15,0.43,0.27,0.65,0.38l0.18,1.28\r c0.04,0.33,0.32,0.57,0.65,0.57h2.25c0.33,0,0.61-0.24,0.65-0.56l0.18-1.28c0.23-0.11,0.45-0.24,0.65-0.38l1.21,0.48\r c0.31,0.12,0.65,0,0.81-0.29l1.13-1.95C17.92,14.73,17.85,14.38,17.59,14.18z M12,15.5c-1.38,0-2.5-1.12-2.5-2.5s1.12-2.5,2.5-2.5\r s2.5,1.12,2.5,2.5S13.38,15.5,12,15.5z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{show_image:{type:"boolean",default:!0},show_count:{type:"boolean",default:!0},show_description:{type:"boolean",default:!0},parent:{type:"string",default:""},categories:{type:"string",default:""},exclude_categories:{type:"string",default:""},hide_empty:{type:"boolean",default:!0},depth:{type:"number",default:3},number:{type:"number",default:3},columns_count:{type:"number",default:3},orderby:{type:"string",default:"none"},order:{type:"string",default:"desc"}},edit:class extends Jt{constructor(){super(...arguments)}render(){return wp.element.createElement(Xt,null,wp.element.createElement(Kt,this.props),wp.element.createElement(es,null,wp.element.createElement(Zt,{block:"motopress-appointment/service-categories",attributes:this.props.attributes})))}},save:()=>null});const{Component:ss,Fragment:is}=wp.element,{SelectControl:ns,PanelBody:as,TextControl:os,ToggleControl:rs,RangeControl:ls}=wp.components,{InspectorControls:ps}=wp.blockEditor||wp.editor;let ms=class extends ss{render(){const{show_image:e,show_title:t,show_excerpt:i,show_price:n,show_duration:a,show_capacity:o,show_employees:r,services:l,employees:p,categories:m,tags:c,posts_per_page:h,columns_count:d,orderby:u,order:g}=this.props.attributes,{setAttributes:y}=this.props;return[wp.element.createElement(ps,{key:"inspector"},wp.element.createElement(is,null,wp.element.createElement(as,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(rs,{label:s.__("Show featured image.","motopress-appointment"),checked:e,onChange:e=>{y({show_image:e})}}),wp.element.createElement(rs,{label:s.__("Show post title.","motopress-appointment"),checked:t,onChange:e=>{y({show_title:e})}}),wp.element.createElement(rs,{label:s.__("Show post excerpt.","motopress-appointment"),checked:i,onChange:e=>{y({show_excerpt:e})}}),wp.element.createElement(rs,{label:s.__("Show service price.","motopress-appointment"),checked:n,onChange:e=>{y({show_price:e})}}),wp.element.createElement(rs,{label:s.__("Show service duration.","motopress-appointment"),checked:a,onChange:e=>{y({show_duration:e})}}),wp.element.createElement(rs,{label:s.__("Show service capacity.","motopress-appointment"),checked:o,onChange:e=>{y({show_capacity:e})}}),wp.element.createElement(rs,{label:s.__("Show service employees.","motopress-appointment"),checked:r,onChange:e=>{y({show_employees:e})}}),wp.element.createElement(os,{label:s.__("Services","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of services that will be shown.","motopress-appointment"),value:l,onChange:e=>{y({services:e})}}),wp.element.createElement(os,{label:s.__("Employees","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of employees that perform these services.","motopress-appointment"),value:p,onChange:e=>{y({employees:e})}}),wp.element.createElement(os,{label:s.__("Categories","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of categories that will be shown.","motopress-appointment"),value:m,onChange:e=>{y({categories:e})}}),wp.element.createElement(os,{label:s.__("Tags","motopress-appointment"),help:s.__("Comma-separated slugs or IDs of tags that will be shown.","motopress-appointment"),value:c,onChange:e=>{y({tags:e})}}),wp.element.createElement(ls,{label:s.__("Posts Per Page","motopress-appointment"),value:h,onChange:e=>y({posts_per_page:e}),min:-1,max:100,placeholder:"0"}),wp.element.createElement(ls,{label:s.__("Columns Count","motopress-appointment"),help:s.__("The number of columns in the grid.","motopress-appointment"),value:d,onChange:e=>y({columns_count:e}),min:0,max:100,placeholder:"0"}),wp.element.createElement(ns,{label:s.__("Order By","motopress-appointment"),value:void 0!==u?u:"none",onChange:e=>y({orderby:e}),options:[{value:"none",label:s.__("No order","motopress-appointment")},{value:"ID",label:s.__("Post ID","motopress-appointment")},{value:"author",label:s.__("Post author","motopress-appointment")},{value:"title",label:s.__("Post title","motopress-appointment")},{value:"name",label:s.__("Post name (post slug)","motopress-appointment")},{value:"date",label:s.__("Post date","motopress-appointment")},{value:"modified",label:s.__("Last modified date","motopress-appointment")},{value:"rand",label:s.__("Random order","motopress-appointment")},{value:"relevance",label:s.__("Relevance","motopress-appointment")},{value:"menu_order",label:s.__("Page order","motopress-appointment")},{value:"menu_order title",label:s.__("Page order and post title","motopress-appointment")},{value:"price",label:s.__("Price","motopress-appointment")}]}),"none"!==u&&wp.element.createElement(ns,{label:s.__("Order","motopress-appointment"),value:void 0!==g?g:"desc",onChange:e=>y({order:e}),options:[{value:"desc",label:s.__("DESC","motopress-appointment")},{value:"asc",label:s.__("ASC","motopress-appointment")}]}))))]}};const{serverSideRender:cs}=wp,{Component:hs,Fragment:ds}=wp.element,{Disabled:us}=wp.components;const{registerBlockType:gs}=wp.blocks;gs("motopress-appointment/services-list",{title:s.__("Services List","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M17.59,7.18l-1.02-0.8c0.01-0.11,0.02-0.24,0.02-0.38s-0.01-0.27-0.02-0.38l1.02-0.8c0.26-0.21,0.32-0.57,0.16-0.85\r l-1.12-1.92c-0.16-0.29-0.51-0.41-0.82-0.3l-1.2,0.48c-0.21-0.15-0.43-0.27-0.65-0.38l-0.18-1.28C13.73,0.24,13.45,0,13.12,0h-2.25\r c-0.33,0-0.61,0.24-0.65,0.56l-0.18,1.28C9.81,1.95,9.59,2.08,9.38,2.22l-1.2-0.48c-0.31-0.12-0.65,0-0.81,0.29L6.24,3.97\r C6.08,4.25,6.15,4.62,6.4,4.82l1.02,0.8C7.41,5.76,7.41,5.88,7.41,6s0,0.24,0.02,0.38L6.4,7.18C6.15,7.39,6.08,7.75,6.24,8.03\r l1.12,1.92c0.16,0.29,0.51,0.41,0.82,0.29l1.2-0.48c0.21,0.15,0.43,0.27,0.65,0.38l0.18,1.28c0.04,0.33,0.32,0.57,0.65,0.57h2.25\r c0.33,0,0.61-0.24,0.65-0.56l0.18-1.28c0.23-0.11,0.45-0.24,0.65-0.38l1.21,0.48c0.31,0.12,0.65,0,0.81-0.29l1.13-1.95\r C17.92,7.73,17.85,7.38,17.59,7.18z M12,8.5c-1.38,0-2.5-1.12-2.5-2.5s1.12-2.5,2.5-2.5s2.5,1.12,2.5,2.5S13.38,8.5,12,8.5z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{show_image:{type:"boolean",default:!0},show_title:{type:"boolean",default:!0},show_excerpt:{type:"boolean",default:!0},show_price:{type:"boolean",default:!0},show_duration:{type:"boolean",default:!0},show_capacity:{type:"boolean",default:!0},show_employees:{type:"boolean",default:!0},services:{type:"string",default:""},employees:{type:"string",default:""},categories:{type:"string",default:""},tags:{type:"string",default:""},posts_per_page:{type:"number",default:3},columns_count:{type:"number",default:3},orderby:{type:"string",default:"none"},order:{type:"string",default:"desc"}},edit:class extends hs{constructor(){super(...arguments)}render(){return wp.element.createElement(ds,null,wp.element.createElement(ms,this.props),wp.element.createElement(us,null,wp.element.createElement(cs,{block:"motopress-appointment/services-list",attributes:this.props.attributes})))}},save:()=>null});const{Component:ys,Fragment:bs}=wp.element,{PanelBody:_s,TextControl:fs}=wp.components,{InspectorControls:vs}=wp.blockEditor||wp.editor;let ws=class extends ys{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(vs,{key:"inspector"},wp.element.createElement(bs,null,wp.element.createElement(_s,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(fs,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:Cs}=wp,{Component:Ss,Fragment:Es}=wp.element,{Disabled:ks}=wp.components;const{registerBlockType:Ps}=wp.blocks;Ps("motopress-appointment/employee-image",{title:s.__("Employee Image","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends Ss{constructor(e){super(...arguments)}render(){return wp.element.createElement(Es,null,wp.element.createElement(ws,this.props),wp.element.createElement(ks,null,wp.element.createElement(Cs,{block:"motopress-appointment/employee-image",attributes:this.props.attributes})))}},save:()=>null});const{Component:Ts,Fragment:Is}=wp.element,{PanelBody:$s,TextControl:Ds}=wp.components,{InspectorControls:xs}=wp.blockEditor||wp.editor;let Ms=class extends Ts{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(xs,{key:"inspector"},wp.element.createElement(Is,null,wp.element.createElement($s,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(Ds,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:As}=wp,{Component:Bs,Fragment:Ls}=wp.element,{Disabled:Fs}=wp.components;const{registerBlockType:Rs}=wp.blocks;Rs("motopress-appointment/employee-title",{title:s.__("Employee Title","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends Bs{constructor(e){super(...arguments)}render(){return wp.element.createElement(Ls,null,wp.element.createElement(Ms,this.props),wp.element.createElement(Fs,null,wp.element.createElement(As,{block:"motopress-appointment/employee-title",attributes:this.props.attributes})))}},save:()=>null});const{Component:Os,Fragment:Ns}=wp.element,{PanelBody:Hs,TextControl:Vs}=wp.components,{InspectorControls:zs}=wp.blockEditor||wp.editor;let qs=class extends Os{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(zs,{key:"inspector"},wp.element.createElement(Ns,null,wp.element.createElement(Hs,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(Vs,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:Us}=wp,{Component:js,Fragment:Ws}=wp.element,{Disabled:Gs}=wp.components;const{registerBlockType:Ys}=wp.blocks;Ys("motopress-appointment/employee-services-list",{title:s.__("Employee Services List","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends js{constructor(e){super(...arguments)}render(){return wp.element.createElement(Ws,null,wp.element.createElement(qs,this.props),wp.element.createElement(Gs,null,wp.element.createElement(Us,{block:"motopress-appointment/employee-services-list",attributes:this.props.attributes})))}},save:()=>null});const{Component:Qs,Fragment:Ks}=wp.element,{PanelBody:Zs,TextControl:Js}=wp.components,{InspectorControls:Xs}=wp.blockEditor||wp.editor;let ei=class extends Qs{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(Xs,{key:"inspector"},wp.element.createElement(Ks,null,wp.element.createElement(Zs,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(Js,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:ti}=wp,{Component:si,Fragment:ii}=wp.element,{Disabled:ni}=wp.components;const{registerBlockType:ai}=wp.blocks;ai("motopress-appointment/employee-schedule",{title:s.__("Employee Schedule","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends si{constructor(e){super(...arguments)}render(){return wp.element.createElement(ii,null,wp.element.createElement(ei,this.props),wp.element.createElement(ni,null,wp.element.createElement(ti,{block:"motopress-appointment/employee-schedule",attributes:this.props.attributes})))}},save:()=>null});const{Component:oi,Fragment:ri}=wp.element,{PanelBody:li,TextControl:pi}=wp.components,{InspectorControls:mi}=wp.blockEditor||wp.editor;let ci=class extends oi{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(mi,{key:"inspector"},wp.element.createElement(ri,null,wp.element.createElement(li,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(pi,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:hi}=wp,{Component:di,Fragment:ui}=wp.element,{Disabled:gi}=wp.components;const{registerBlockType:yi}=wp.blocks;yi("motopress-appointment/employee-content",{title:s.__("Employee Content","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends di{constructor(e){super(...arguments)}render(){return wp.element.createElement(ui,null,wp.element.createElement(ci,this.props),wp.element.createElement(gi,null,wp.element.createElement(hi,{block:"motopress-appointment/employee-content",attributes:this.props.attributes})))}},save:()=>null});const{Component:bi,Fragment:_i}=wp.element,{PanelBody:fi,TextControl:vi}=wp.components,{InspectorControls:wi}=wp.blockEditor||wp.editor;let Ci=class extends bi{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(wi,{key:"inspector"},wp.element.createElement(_i,null,wp.element.createElement(fi,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(vi,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:Si}=wp,{Component:Ei,Fragment:ki}=wp.element,{Disabled:Pi}=wp.components;const{registerBlockType:Ti}=wp.blocks;Ti("motopress-appointment/employee-contacts",{title:s.__("Employee Contact Information","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends Ei{constructor(e){super(...arguments)}render(){return wp.element.createElement(ki,null,wp.element.createElement(Ci,this.props),wp.element.createElement(Pi,null,wp.element.createElement(Si,{block:"motopress-appointment/employee-contacts",attributes:this.props.attributes})))}},save:()=>null});const{Component:Ii,Fragment:$i}=wp.element,{PanelBody:Di,TextControl:xi}=wp.components,{InspectorControls:Mi}=wp.blockEditor||wp.editor;let Ai=class extends Ii{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(Mi,{key:"inspector"},wp.element.createElement($i,null,wp.element.createElement(Di,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(xi,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}};const{serverSideRender:Bi}=wp,{Component:Li,Fragment:Fi}=wp.element,{Disabled:Ri}=wp.components;const{registerBlockType:Oi}=wp.blocks;Oi("motopress-appointment/employee-social-networks",{title:s.__("Employee Social Networks","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends Li{constructor(e){super(...arguments)}render(){return wp.element.createElement(Fi,null,wp.element.createElement(Ai,this.props),wp.element.createElement(Ri,null,wp.element.createElement(Bi,{block:"motopress-appointment/employee-social-networks",attributes:this.props.attributes})))}},save:()=>null});const{Component:Ni,Fragment:Hi}=wp.element,{PanelBody:Vi,TextControl:zi}=wp.components,{InspectorControls:qi}=wp.blockEditor||wp.editor;class Ui extends Ni{render(){const{id:e}=this.props.attributes,{setAttributes:t}=this.props;return[wp.element.createElement(qi,{key:"inspector"},wp.element.createElement(Hi,null,wp.element.createElement(Vi,{title:s.__("Settings","motopress-appointment"),initialOpen:!0},wp.element.createElement(zi,{label:s.__("ID","motopress-appointment"),help:s.__("Post ID of an employee to display content from. Note: this parameter automatically uses the current post ID when a shortcode is inside the employee's post and is required otherwise.","motopress-appointment"),value:e,onChange:e=>{t({id:e})}}))))]}}const{serverSideRender:ji}=wp,{Component:Wi,Fragment:Gi}=wp.element,{Disabled:Yi}=wp.components;const{registerBlockType:Qi}=wp.blocks;Qi("motopress-appointment/employee-additional-info",{title:s.__("Employee Additional Information","motopress-appointment"),icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},wp.element.createElement("polygon",{points:"24,21 6,21 6,23 24,23 "}),wp.element.createElement("path",{d:"M2,20c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,20,2,20L2,20z"}),wp.element.createElement("polygon",{points:"24,15 6,15 6,17 24,17 "}),wp.element.createElement("path",{d:"M2,14c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S3.1,14,2,14L2,14z"}),wp.element.createElement("path",{d:"M14.93,6.7C15.59,5.99,16,5.05,16,4c0-2.21-1.79-4-4-4S8,1.79,8,4c0,1.05,0.41,1.99,1.07,2.7C6.95,7.78,5.5,9.97,5.5,12.5\r c0,0.17,0.01,0.33,0.03,0.5H6h1.55h8.9H17h1.47c0.01-0.17,0.03-0.33,0.03-0.5C18.5,9.97,17.05,7.78,14.93,6.7z M12,2\r c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M12,8c1.95,0,3.6,1.26,4.22,3H7.78C8.4,9.26,10.05,8,12,8z"})),category:"mpa-gutenberg-blocks",keywords:[s.__("appointment","motopress-appointment")],supports:{anchor:!0,customClassName:!0},attributes:{id:{type:"string",default:""}},edit:class extends Wi{constructor(e){super(...arguments)}render(){return wp.element.createElement(Gi,null,wp.element.createElement(Ui,this.props),wp.element.createElement(Yi,null,wp.element.createElement(ji,{block:"motopress-appointment/employee-additional-info",attributes:this.props.attributes})))}},save:()=>null})}(React,wp.date,wp.i18n,mpaData,intlTelInput)}();
