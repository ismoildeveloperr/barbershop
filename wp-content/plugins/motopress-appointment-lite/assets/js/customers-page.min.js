!function(){"use strict";!function(t,e,n){class s{constructor(t){this.$element=t,this.type=t.data("type"),this.$element.attr("data-inited","true")}}let i="/motopress/appointment/v1";function r(t,e={}){return function(t,e={},n="GET"){return new Promise(((s,r)=>{wp.apiRequest({path:i+t,type:n,data:e}).done((t=>s(t))).fail(((t,e)=>{let n="parsererror";n=t.responseJSON&&t.responseJSON.message?t.responseJSON.message:`Status: ${e}`,"parsererror"==n&&(n="REST request failed. Maybe PHP error on the server side. Check PHP logs."),r(new Error(n))}))}))}(t,e,"GET")}class o{constructor(){this.settings=this.getDefaults(),this.loadingPromise=this.load()}getDefaults(){return{plugin_name:"Appointment Booking",today:"2030-01-01",business_name:"",default_time_step:30,default_booking_status:"confirmed",confirmation_mode:"auto",terms_page_id_for_acceptance:0,allow_multibooking:!1,allow_coupons:!1,allow_customer_account_creation:!1,country:"",currency:"EUR",currency_symbol:"&euro;",currency_position:"before",decimal_separator:".",thousand_separator:",",number_of_decimals:2,timezone:"UTC",date_format:"F j, Y",time_format:"H:i",week_starts_on:0,thumbnail_size:{width:150,height:150},flatpickr_locale:"en",enable_payments:!1,active_gateways:[],reservation_received_page_url:"",failed_transaction_page_url:"",default_payment_gateway:""}}load(){return new Promise(((t,e)=>{r("/settings").then((t=>this.settings=t),(t=>console.error("Unable to load public settings.",t))).finally((()=>t(this.settings)))}))}ready(){return this.loadingPromise}getPluginName(){return this.settings.plugin_name}getBusinessDate(){return this.settings.today}getBusinessName(){return this.settings.business_name}getTimeStep(){return this.settings.default_time_step}getDefaultBookingStatus(){return this.settings.default_booking_status}getConfirmationMode(){return this.settings.confirmation_mode}getTermsPageIdForAcceptance(){return this.settings.terms_page_id_for_acceptance}isMultibookingEnabled(){return this.settings.allow_multibooking}isCouponsEnabled(){return this.settings.allow_coupons}isAllowCustomerAccountCreation(){return this.settings.allow_customer_account_creation}getCountry(){return this.settings.country}getCurrency(){return this.settings.currency}getCurrencySymbol(){return this.settings.currency_symbol}getCurrencyPosition(){return this.settings.currency_position}getDecimalSeparator(){return this.settings.decimal_separator}getThousandSeparator(){return this.settings.thousand_separator}getDecimalsCount(){return this.settings.number_of_decimals}getTimezone(){return this.settings.timezone}getDateFormat(){return this.settings.date_format}getTimeFormat(){return this.settings.time_format}getFirstDayOfWeek(){return this.settings.week_starts_on}getThumbnailSize(){return this.settings.thumbnail_size}getFlatpickrLocale(){return this.settings.flatpickr_locale}isPaymentsEnabled(){return this.settings.enable_payments}getActiveGateways(){return this.settings.active_gateways}getReservationReceivedPageUrl(){return this.settings.reservation_received_page_url}getFailedTransactionPageUrl(){return this.settings.failed_transaction_page_url}getDefaultPaymentGateway(){return this.settings.default_payment_gateway}}class a{constructor(){this.settingsCtrl=new o,this.loadingPromise=this.load()}load(){return Promise.all([this.settingsCtrl.ready()]).then((()=>this))}ready(){return this.loadingPromise}settings(){return this.settingsCtrl}static getInstance(){return null==a.instance&&(a.instance=new a),a.instance}}const p="undefined"!=typeof wp&&wp.i18n&&wp.i18n.__?wp.i18n.__:(t,e="")=>t,m="undefined"!=typeof wp&&wp.i18n&&wp.i18n._x?wp.i18n._x:(t,e,n="")=>t;function u(t){const s=jQuery("<span/>",{id:t.attr("id")+"_error",class:"mpa-phone-field-error mpa-hide",text:p("Phone number is invalid.","motopress-appointment")});t.after("<br>",s);const i=e(t[0],{separateDialCode:!0,initialCountry:n.settings.country,hiddenInput:t.attr("name"),utilsScript:n.urls.plugin+"assets/js/intl-tel-input-17.0.19/js/utils.js"});i.promise.then((()=>{t.val()&&r(),t.on("countrychange",(t=>{r()})),t.on("input",(t=>{r()}))}));const r=()=>{i.isValidNumber()?(jQuery("input[type='hidden'][name='"+t.attr("name")+"']").val(i.getNumber(intlTelInputUtils.numberFormat.E164)),t.removeClass("mpa-phone-number--invalid"),s.addClass("mpa-hide")):(t.addClass("mpa-phone-number--invalid"),s.removeClass("mpa-hide"))};return i}"undefined"!=typeof wp&&wp.i18n&&wp.i18n.sprintf&&wp.i18n.sprintf,p("Sun","motopress-appointment"),p("Mon","motopress-appointment"),p("Tue","motopress-appointment"),p("Wed","motopress-appointment"),p("Thu","motopress-appointment"),p("Fri","motopress-appointment"),p("Sat","motopress-appointment"),p("Sunday","motopress-appointment"),p("Monday","motopress-appointment"),p("Tuesday","motopress-appointment"),p("Wednesday","motopress-appointment"),p("Thursday","motopress-appointment"),p("Friday","motopress-appointment"),p("Saturday","motopress-appointment"),p("Jan","motopress-appointment"),p("Feb","motopress-appointment"),p("Mar","motopress-appointment"),p("Apr","motopress-appointment"),m("May","Month (short)","motopress-appointment"),p("Jun","motopress-appointment"),p("Jul","motopress-appointment"),p("Aug","motopress-appointment"),p("Sep","motopress-appointment"),p("Oct","motopress-appointment"),p("Nov","motopress-appointment"),p("Dec","motopress-appointment"),p("January","motopress-appointment"),p("February","motopress-appointment"),p("March","motopress-appointment"),p("April","motopress-appointment"),m("May","Month","motopress-appointment"),p("June","motopress-appointment"),p("July","motopress-appointment"),p("August","motopress-appointment"),p("September","motopress-appointment"),p("October","motopress-appointment"),p("November","motopress-appointment"),p("December","motopress-appointment"),a.getInstance().settings().getFirstDayOfWeek(),window.mpa_intl_tel_input=u;class l extends s{constructor(t){super(t),this.$input=t.find("input").first(),u(this.$input)}}new class{constructor(){this.setupFields(jQuery(".mpa-ctrl:not([data-inited])"))}setupFields(t){t.each((function(t,e){let n=jQuery(e);if("phone"===n.attr("data-type"))new l(n)}))}}}(wp.date,intlTelInput,mpaData)}();
